<!-- build time:Mon Jan 29 2024 17:14:11 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="·恆 ·極 ·諭" href="https://ekkoxiao.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="·恆 ·極 ·諭" href="https://ekkoxiao.github.io/atom.xml"><link rel="alternate" type="application/json" title="·恆 ·極 ·諭" href="https://ekkoxiao.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://ekkoxiao.github.io/2024/01/29/cs/net/net/"><title>计算机网络原理课程笔记 - 计算机网络原理 - 计算机专业课程笔记 | Homepage for EkkoXiao = ·恆 ·極 ·諭 = 鹿车自泰然，凤翔岂雀雁</title><meta name="generator" content="Hexo 7.1.1"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">计算机网络原理课程笔记</h1><div class="meta"><span class="item" title="创建时间：2024-01-29 16:47:07"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2024-01-29T16:47:07+08:00">2024-01-29</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>24k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>22 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Homepage for EkkoXiao</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="/assets/net.png"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/cs/" itemprop="item" rel="index" title="分类于 计算机专业课程笔记"><span itemprop="name">计算机专业课程笔记</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/cs/net/" itemprop="item" rel="index" title="分类于 计算机网络原理"><span itemprop="name">计算机网络原理</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://ekkoxiao.github.io/2024/01/29/cs/net/net/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Linxin Xiao"><meta itemprop="description" content="鹿车自泰然，凤翔岂雀雁, Tsinghua University, Peking"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="·恆 ·極 ·諭"></span><div class="body md" itemprop="articleBody"><h2 id="ch01-01-引言"><a class="anchor" href="#ch01-01-引言">#</a> CH01-01 引言</h2><h3 id="dos-拒绝服务攻击"><a class="anchor" href="#dos-拒绝服务攻击">#</a> DoS 拒绝服务攻击</h3><p>攻击者通过制造大量虚假流量占用资源，使合法流量无法使用资源 (服务、带宽)<br>分布式 Dos（DDoS）：从被入侵的僵尸主机向目标发送大量数据包，导致目标主机无法应对<br>反射放大 DoS 攻击，通过僵尸网络（将大量主机感染 bot 程序（僵尸程序）病毒，从而在控制者和被感染主机之间所形成的一个可一对多控制的网络）躲避追查</p><h2 id="ch02-01-计算机网络体系结构"><a class="anchor" href="#ch02-01-计算机网络体系结构">#</a> CH02-01 计算机网络体系结构</h2><h3 id="电路交换"><a class="anchor" href="#电路交换">#</a> 电路交换</h3><p>采用面向连接方式，现呼叫建立预留资源，之后物理通路被通信双方独占不共享<br>发送的时候直接发送（源到目的）<br>频分多路复用，时分多路复用<br>缺点：抗毁性差，无法应对突发流量</p><h3 id="报文交换"><a class="anchor" href="#报文交换">#</a> 报文交换</h3><p>路由器<strong>存储</strong>与<strong>转发</strong>报文，不需预留资源。<br>带来传输延迟：路由器接收完整的数据报文后，才能开始向下一跳发送</p><h3 id="分组交换"><a class="anchor" href="#分组交换">#</a> 分组交换</h3><p>将大报文拆成小的数据段，加上首部构成分组，每个分组的首部都含有地址（目的地址和源地址）等控制信息并独立选择路径<br>统计多路复用：多个主机的报文按需共享带宽<br>分组交换适合有大量突发数据传输需求的互联网<br>缺点：需要协议来保障可靠的数据传输，拥塞控制</p><h3 id="协议与分层结构"><a class="anchor" href="#协议与分层结构">#</a> 协议与分层结构</h3><p>在每一对相邻层次之间的是接口；接口定义了下层向上层提供哪些<strong>服务原语</strong>，<strong>层和协议的集合</strong>为网络体系结构<br>面向连接：每个请求或响应都产生一个指示或确认（打电话）；无连接：传输过程不需要应答（邮政）<br>协议是 “水平” 的，服务是 “垂直” 的<br>OSI：应用层 表示层 会话层 传输层 网络层 数据链路层 物理层<br>TCP/IP：应用层 传输层 互联网层 网络接口层<br>OSI 模型<strong>网络层</strong>能够支持无连接和面向连接通信，TCP/IP 模型的<strong>网络层</strong>仅支持无连接通信（IP）<br>发送端层层封装，接收端层层解封装</p><h3 id="度量单位"><a class="anchor" href="#度量单位">#</a> 度量单位</h3><p>比特率（带宽）：bps<br>分组转发率：PPS<br>传输时延 (transmission delay)：数据从结点进入到传输媒体所需要的时间，又称为发送时延（数据大小 / 比特率）<br>传播时延 (propagation delay)：电磁波在信道中需要传播一定距离而花费的时间（距离 / 光速）<br>处理时延 (processing delay)：主机或路由器在收到分组时，为处理分组（例如分析首部、提<br>取数据、差错检验或查找路由）所花费的时间<br>排队时延 (queueing delay)：分组在路由器输入输出队列中排队等待处理所经历的时延<br><strong>往返时延 RTT（Round-Trip Time）</strong>：从发送方发送数据开始，到发送方收到来自接收方的确认，经历的总时间<br>吞吐量（throughput）：单位时间内通过某个网络 (或信道、接口) 的数据量，单位是 b/s<br>信道利用率：某信道有百分之几的时间是被利用的<br><strong>时延带宽积</strong>：传播时延 * 带宽</p><h2 id="ch03-01-物理层"><a class="anchor" href="#ch03-01-物理层">#</a> CH03-01 物理层</h2><h3 id="简介"><a class="anchor" href="#简介">#</a> 简介</h3><p>功能：如何在连接各计算机的传输媒介上传输数据比特流<br>作用：尽可能地屏蔽掉不同传输媒介和通信手段的差异<br>四个特性：机械，电气，功能，过程<br>机械特性：接线器的形状和尺寸、引线数目和排列、固定和锁定装置等<br>电气特性：发送器和接收器的电路特性、负载要求、传输速率和连接距离等，如发送信号电平、发送器和接收器的输出阻抗、平衡特性等<br>功能特性：描述接口执行的功能，定义接线器的每一引脚 (针，Pin) 的作用<br>过程特性：指明对于不同功能的各种可能事件的出现顺序</p><h3 id="带宽信号"><a class="anchor" href="#带宽信号">#</a> 带宽信号</h3><p>PPT P18 傅里叶分析计算 c, an, bn<br>频谱是信号所包含的频率的范围<br>信号的主要能量集中在相对窄的频带内，这个频带被称为有效带宽，或带宽<br>带宽越宽，信息承载能力越强<br>波特率：每秒钟信号变化的次数，也称调制速率（频谱带宽）<br>若每个信号值表示 n 位，则比特率是波特率的 n 倍<br>无噪声有限带宽信号的最大数据传输率 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>H</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>V</mi></mrow><annotation encoding="application/x-tex">2Hlog_2V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:.08125em">H</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.22222em">V</span></span></span></span> (bps)，H 为带宽（Hz），V 为信号电平级数<br>信噪比：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>10</mn></msub><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">10log_{10}S/N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:.10903em">N</span></span></span></span> 分贝，S 为信号功率，N 为噪声功率<br>香农定理：带宽为 H 赫兹，信噪比为 S/N （分贝，要用上一行的公式计算）的信道，最大数据传输率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Hlog_2(1+S/N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.08125em">H</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span></span></span></span>(bps)</p><h3 id="传输方式"><a class="anchor" href="#传输方式">#</a> 传输方式</h3><p>一条消息所荷载的信息量等于它所表示的事件发生的概率 p 的倒数的对数<br>传输方式分为串行和并行，点到点和点到多点，单工，半双工和全双工</p><h3 id="传输介质"><a class="anchor" href="#传输介质">#</a> 传输介质</h3><p>导引型（双绞线，同轴电缆，光纤，电力载波），非导引型（无线电波，光波）<br>卫星通信：利用人造地球卫星作为中继站，转发或反射无线电波，在两个或多个地球站之间进行的通信</p><h3 id="数字调制与多路复用"><a class="anchor" href="#数字调制与多路复用">#</a> 数字调制与多路复用</h3><h4 id="基带传输"><a class="anchor" href="#基带传输">#</a> 基带传输</h4><p>未对载波调制的待传信号称为基带信号，基带传输，指一种不搬移基带信号频谱的传输方式。<br>不归零制码：用两种不同的电平分别表示二进制信息 “0” 和 “1”，低电平表示 “0”，高电平表示 “1”。<br>缺点：难以分辨一位的开始和结束，发送方和接收方必须有时钟同步。<br>曼彻斯特码：每一位中间都有一个跳变，从低跳到高表示 “0”，从高跳到低表示 “1”。<br>差分曼彻斯特码：每一位中间都有一个跳变，每位开始时有跳变表示 “0”，无跳变表示 “1”。位中间跳变表示时钟，位前跳变表示数据。</p><h4 id="频带传输"><a class="anchor" href="#频带传输">#</a> 频带传输</h4><p>在一定频率范围内的线路上，进行载波传输。用基带信号对载波进行调制，使其变为适合于线路传送的信号。<br>幅移键控法（调幅）：把振幅作为变量<br>频移键控法 （调频）：把频率作为变量<br>相移键控法（调相）：把相位作为变量</p><h4 id="复用技术"><a class="anchor" href="#复用技术">#</a> 复用技术</h4><p>频分复用（FDM）：将整个频率带宽分为多份，用户在分配到一定的频带后，在通信过程中自始至终都占用这个频带<br>波分复用（WDM）：是利用多个激光器在单条光纤上同时发送多束不同波长激光的技术（光的频分复用）<br>时分复用：将时间划分为一段段等长的时分复用帧（TDM 帧），所有用户在每一个 TDM 帧中占用固定序号的时隙，在不同的时间占用同样的频带宽度；造成线路资源的浪费<br>统计时分复用 (STDM)：动态地按需分配共用信道的时隙<br>码分复用（CDMA）：利用码序列相关性实现的多址通信，靠不同的地址码来区分的地址<br>每一个比特时间划分为 m 个短的间隔，称为码片 (chip)，每个站被指派一个唯一的 m bit 码片序列，发送比特 1 时发送自己的码片序列，否则发送码片序列的反码。<br>每个站分配的码片序列不仅必须各不相同，并且还必须互相正交，且与自己的<strong>规格化内积</strong>为 1（不是模为 1）。<br>收到码片序列后分别与每个站的码片序列内积，若结果为 1 则发送了 1，为 0 则未发送，为 -1 则发送了 0。</p><h2 id="ch04-01-数据链路层基础"><a class="anchor" href="#ch04-01-数据链路层基础">#</a> CH04-01 数据链路层基础</h2><h3 id="成帧"><a class="anchor" href="#成帧">#</a> 成帧</h3><p>接收方必须能从物理层接收的比特流中明确区分出一帧的开始和结束（帧同步或帧定界）</p><h4 id="字节计数法"><a class="anchor" href="#字节计数法">#</a> 字节计数法</h4><p>在帧首部一个字节表示帧的长度<br>如果该字节出错，则导致一连串的错误</p><h4 id="带字节填充的定界符法"><a class="anchor" href="#带字节填充的定界符法">#</a> 带字节填充的定界符法</h4><p>定界符（FLAG）：一个特殊的字节，比如 01111110，即 0x7E，用于区分前后两个不同的帧。<br>定义转义字节 ESC，当有效载荷中出现 ESC 或 FLAG 时在每一个 ESC/FLAG 前填充 ESC<br>接收方收到 ESC 则无条件使后一字节成为有效载荷，收到 FLAG 则为边界<br>缺点：不够灵活</p><h4 id="带比特填充的定界符法"><a class="anchor" href="#带比特填充的定界符法">#</a> 带比特填充的定界符法</h4><p>定界符：两个 0 比特之间，连续 6 个 1 比特<br>发送方检查有效载荷，若在有效载荷中出现连续 5 个 1 比特，则直接插入 1 个 0 比特<br>接收方若出现连续 5 个 1 比特，若下一比特为 0，则为有效载荷，直接丢弃 0；否则为定界符</p><h4 id="物理层编码违例"><a class="anchor" href="#物理层编码违例">#</a> 物理层编码违例</h4><p>核心思想：选择的定界符不会在数据部分出现<br>4B/5B：4 比特数据映射成 5 比特编码，剩余的一半码字（16 个码字）未使用，可以用做帧定界符<br>曼切斯特编码 / 差分曼切斯特编码：持续的高电平（或低电平）为违例码，可以用作定界符<br>前导码：存在很长的 前导码（preamble），可以用作定界符</p><h3 id="差错检测和纠正"><a class="anchor" href="#差错检测和纠正">#</a> 差错检测和纠正</h3><p>目标：保证一定差错检测和纠错能力的前提下，减少冗余信息量<br>一个 n = m + r 位单元（含 m 个数据位和 r 个校验位），描述为 <strong>(n, m) 码</strong><br>码率：码字中不含冗余部分所占的比例，可以用 m/n 表示</p><h4 id="海明距离"><a class="anchor" href="#海明距离">#</a> 海明距离</h4><p>两个码字之间对应不同比特的数目<br>海明距离为 d 的编码，可以检测 d-1 个单比特错误<br>海明距离为 d 的编码，可以纠正 <strong>(d-1)/2</strong> 个单比特错误（距离码字 A 的距离小于码字 B，才能被纠正成码字 A）</p><h4 id="检错码"><a class="anchor" href="#检错码">#</a> 检错码</h4><p>在数据块中包含一些冗余信息，使接收方能够推断是否发生错误，但不能推断哪位发生错误</p><p>奇偶检验：增加 1 位校验位，可以检查奇数位错误（保证 1 的个数为奇数 / 偶数个）</p><p>校验和：发送方进行 16 位二进制补码求和运算，计算结果取反，随数据一同发送；接收方进行 16 位二进制补码求和运算（包含校验和），若结果非全 1，则检测到错误。</p><h5 id="循环冗余校验-crc"><a class="anchor" href="#循环冗余校验-crc">#</a> 循环冗余校验 CRC</h5><p>生成多项式 G：如果要产生 n 位 CRC 校验码，事先选定一个 n+1 位二进制 G，最高位为 1<br>将原始数据 D 乘以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>，即补充 n 个 0，用 G 对该数做模 2 除（异或），得到余数 R 即为 CRC 校验码（n 位，不足 n 位前面用 0 补齐）<br>发送数据：原始数据 D 之后拼接 CRC 校验码（即余数 R），得到发送数据 T<br>校验过程：T 除以 G，余数为 0<br>校验能力：能检测出少于 n + 1 位的突发错误</p><h4 id="纠错码海明码"><a class="anchor" href="#纠错码海明码">#</a> 纠错码 —— 海明码</h4><p>主要用于错误发生比较频繁的信道上，如无线链路。<br>校验位：2 的幂次方位（记为 p1, p2, p4, p8）<br>数据位 k 写成 2 的幂的和，对这些校验位有影响。<br>缺省为偶校验（也可以使用奇校验）<br>通过每组的校验找出错误的位置（有错误的校验位相加）<br>只能提供一位纠错能力</p><h3 id="基本的数据链路层协议"><a class="anchor" href="#基本的数据链路层协议">#</a> 基本的数据链路层协议</h3><h4 id="乌托邦式单工协议-p1"><a class="anchor" href="#乌托邦式单工协议-p1">#</a> 乌托邦式单工协议 P1</h4><p>・单工（Simplex）协议：数据单向传输<br>・完美信道：帧不会丢失或受损<br>・始终就绪：发送方 / 接收方的网络层始终处于就绪状态<br>・瞬间完成：发送方 / 接收方能够生成 / 处理无穷多的数据<br>发送方发送帧的速度过快（大于接收方处理速度），将导致接收方被 “淹没”</p><h4 id="无错信道上的单工停等式协议-p2"><a class="anchor" href="#无错信道上的单工停等式协议-p2">#</a> 无错信道上的单工停等式协议 P2</h4><p>发送方发送一帧后暂停，等待确认到达后发送下一帧；接收方完成接收后，回复确认接收<br>哑帧确认（dummy frame），确认帧的内容是不重要的</p><h4 id="有错信道上的单工停等式协议-p3"><a class="anchor" href="#有错信道上的单工停等式协议-p3">#</a> 有错信道上的单工停等式协议 P3</h4><p>发送方增加一个计时器 (timer)，如果经过一段时间没有收到确认，发送方将超时，于是再次发送该帧。<br>ACK 传输中丢失？产生副本，无法识别是否重复。<br>引入序号（SEQ）让发送方在发送的帧的头部放一个序号，接收方可以检查它所收到的帧序号，由此判断这是新帧还是应该被丢弃的重复帧。<br>为精简帧头，序号最小 1 bit 即可（0 或 1）。<br>信道利用率：F/(F + R * RTT)，F 为帧大小，R 为链路带宽，RTT 为发送空闲时间<br>R・RTT = 2 倍时延带宽积（发送后需要经历往返传播延迟才能收到确认再次发送）<br>缺点：信道利用率低</p><h2 id="ch04-02"><a class="anchor" href="#ch04-02">#</a> CH04-02</h2><h3 id="滑动窗口协议"><a class="anchor" href="#滑动窗口协议">#</a> 滑动窗口协议</h3><h4 id="发送窗口"><a class="anchor" href="#发送窗口">#</a> 发送窗口</h4><p>发送端始终保持一个已发送但尚未确认的帧的序号表，称为发送窗口<br>上界表示要发送的下一个帧的序号，下界表示未得到确认的帧的最小序号，窗口大小可变<br>发送新的帧 —— 上界加 1，收到确认帧 —— 下界加 1</p><h4 id="接收窗口"><a class="anchor" href="#接收窗口">#</a> 接收窗口</h4><p>容纳允许接收的信息帧，落在窗口外的帧均被丢弃<br>序号<strong>等于下界的帧</strong>（有时也可以是）被正确接收，并产生一个确认帧，上界、下界都加 1</p><h3 id="一比特滑动窗口协议-p4"><a class="anchor" href="#一比特滑动窗口协议-p4">#</a> 一比特滑动窗口协议 P4</h3><p>信道条件：<strong>全双工</strong>，哑帧确认 -&gt; 捎带确认<br>发送方：从网络层接收分组，放入相应的缓冲区，构造帧，物理层发送并开启计时；等待确认帧到达，从物理层接收一个帧，判断确认号是否正确，正确则停止计时器，并从网络层接收新分组，发送新的帧。<br>接收方：等待帧到达，从物理层接收一个帧，校验和计算，并判断收到的帧序号是否正确，正确则交给网络层处理，期待帧号增加。<br>信息帧中包括两个序号域：发送序号和确认序号<br>问题：若双方同时开始发送，则会有一半重复帧（A 比确认帧先收到 B 发送的帧，因此需要重传）</p><h3 id="回退-n-协议-p5"><a class="anchor" href="#回退-n-协议-p5">#</a> 回退 N 协议 P5</h3><p>发送方和接收方都具有一定容量的缓冲区（即窗口），发送端在收到确认之前可以发送多个帧<br>接收窗口为 1，只能按顺序接收帧，当接收端收到出错帧或乱序帧时，丢弃所有的后继帧，并且不为这些帧发送确认<br>发送端给<strong>整个窗口</strong>设置计时器，超时后，重传所有未被确认的帧<br>出错全部重发时，若帧序号为 n 位，接收窗口 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>R</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">W_R = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.00773em">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>，发送窗口 $W_T ≤ 2^n－1 $<br>ACK 丢失问题？采用<strong>累计确认</strong>策略，ACK (k) 表示对 k - 1 及以前各编号的 PDU 的确认，同时期望接收第 k 号 PDU，这样即使 ACK 丢失也不会影响。<br>出错或乱序的 PDU，只能<strong>反向确认</strong> NACK (k)（期望接收 k 号 PDU）或不应答。<br>如果发送窗口 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>T</mi></msub><mo>=</mo><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">W_T = 2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>，发送端发送完 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> 个帧，但所有确认帧都丢失了。经过一段由超时计时器控制的时间后，发送端重传，但编号仍为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span></span></span></span> 到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.664392em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span>，无法判定是新的数据帧还是老的数据帧。</p><h3 id="选择重传协议-p6"><a class="anchor" href="#选择重传协议-p6">#</a> 选择重传协议 P6</h3><p>给<strong>每个帧</strong>设置定时器，发送端只重传出错帧 / 超时<br>要求发送和接收窗口大小都满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>&lt;</mo><mi>W</mi><mo>≤</mo><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1 &lt; W ≤ 2^{n-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68354em;vertical-align:-.0391em"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8193em;vertical-align:-.13597em"></span><span class="mord mathnormal" style="margin-right:.13889em">W</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8141079999999999em;vertical-align:0"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8141079999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，否则 ACK 丢失时，收到重发的 0 的时候被误认为是下一个 0<br>累计确认在 ACK 丢失时效率高，选择重传在 ACK 丢失时效率低<br>接收方收到窗口内的 ACK 则标记为已确认，但只有窗口下界收到确认，窗口才会移动<br>确认策略改进：按序到达的接收窗口内 PDU 可立即确认，也可延迟确认 (收到多帧后一起确认) ACK (k)；在延迟确认的情况下出错（乱序）用否定性确认 NACK (k)（期望重发 k 号 PDU）</p><h3 id="ppp-协议"><a class="anchor" href="#ppp-协议">#</a> PPP 协议</h3><p>不可靠传输协议，没有必要（难以）在链路层使用复杂协议（序号、检错、重传等）来实现数据的可靠传输（由 TCP 包办）<br>功能特点：成帧，差错检测，设置链路最大传输单元等<br>不实现：纠错，流量控制，单工和半双工（支持全双工），可靠传输，多点连接（只支持点对点）<br>通常使用字符填充法，由于是点对点，帧格式中地址字段冗余（恒为 0xFF），具有控制字段，协议字段，校验 CRC<br>链路控制协议 LCP，网络控制协议 NCP</p><h2 id="ch05-01-介质访问子层基础"><a class="anchor" href="#ch05-01-介质访问子层基础">#</a> CH05-01 介质访问子层基础</h2><h3 id="位置"><a class="anchor" href="#位置">#</a> 位置</h3><p>数据链路层靠近物理层的一侧<br>以太网覆盖数据链路层、物理层共 2 层，IEEE802.3 覆盖 1.5 层。</p><h3 id="纯-aloha"><a class="anchor" href="#纯-aloha">#</a> 纯 ALOHA</h3><p>冲突：两个或以上的帧，随时可能冲突<br>网络负载：某段时间（帧时 D）内所有通信站点总共发送的平均帧数 G<br>用泊松分布刻画某帧时内到达 𝑘 帧的概率，则到达 0 帧的概率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mi>G</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8413309999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">G</span></span></span></span></span></span></span></span></span></span></span></span><br>某个帧 A 被成功传输，要求在该帧邻近 2 个帧时（冲突危险期 2D）内不得有其它帧，概率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>G</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{-2G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8413309999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">G</span></span></span></span></span></span></span></span></span></span></span></span><br>网络吞吐量的计算：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>G</mi><mo>∗</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>2</mn><mi>G</mi></mrow></msup></mrow><annotation encoding="application/x-tex">S = G * e^{-2G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8413309999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">2</span><span class="mord mathnormal mtight">G</span></span></span></span></span></span></span></span></span></span></span></span>，极大值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>0.184</mn></mrow><annotation encoding="application/x-tex">S = 0.184</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">1</span><span class="mord">8</span><span class="mord">4</span></span></span></span>，此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">G = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span>。</p><h3 id="分隙-aloha"><a class="anchor" href="#分隙-aloha">#</a> 分隙 ALOHA</h3><p>把时间分成时隙，时隙的长度对应一帧的传输时间，帧的发送必须在时隙的起点，因此冲突只发生在时隙的起点，冲突危险期减半<br>此时计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>G</mi><mo>∗</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>G</mi></mrow></msup></mrow><annotation encoding="application/x-tex">S = G * e^{-G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.8413309999999999em;vertical-align:0"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.8413309999999999em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathnormal mtight">G</span></span></span></span></span></span></span></span></span></span></span></span>，极大值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>0.368</mn></mrow><annotation encoding="application/x-tex">S = 0.368</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">6</span><span class="mord">8</span></span></span></span>，此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">G = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span></span></span></span>。</p><h3 id="载波侦听多路访问协议-csma"><a class="anchor" href="#载波侦听多路访问协议-csma">#</a> 载波侦听多路访问协议 CSMA</h3><p>站点在为发送帧而访问传输信道之前，首先监听信道有无载波，“先听后发”<br>持续式 CSMA ：如果介质忙，持续侦听，一旦空闲立即发送，若冲突则等待随机时间再开始侦听<br>问题：如果两个以上的站等待发送持续侦听，一旦介质空闲就一定会发生冲突<br>非持续式 CSMA：如果介质忙，则等待随机时间，然后侦听，空闲则开始发送，从而减少再次碰撞冲突的可能性<br>问题：信道利用率下降，传输时延增加，浪费随机等待时间<br>p - 持续式 CSMA：经侦听，如介质空闲，那么以 p 的概率发送，以 (1–p) 的概率延迟一个时间单元发送<br>1 - 持续式是 p - 持续式的特例</p><h3 id="位图协议"><a class="anchor" href="#位图协议">#</a> 位图协议</h3><p>每个周期前设置竞争期：N 个站点就是 N 个比特，要发送则先发送竞争比特，之后根据竞争期中的出现的竞争比特按序发送<br>设每个帧 d 比特，信道利用率低负荷时 d/(d + N)，高负荷时 Nd/(Nd + N) = d/(d + 1)<br>时延较大</p><h3 id="二进制倒计数协议"><a class="anchor" href="#二进制倒计数协议">#</a> 二进制倒计数协议</h3><p>站点：编序号，序号长度相同，若站点要用信道，则广播该站点的序号。<br>不同站发的地址，进行按位 “或” 操作，一旦某站监听到比本站地址高位更高的位置被置为 “1”，便放弃发送请求。<br>信道的利用率为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mi>d</mi><mo>+</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d/(d + log_2N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">d</span><span class="mord">/</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.03588em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mclose">)</span></span></span></span></p><h3 id="ieee-8025-令牌环"><a class="anchor" href="#ieee-8025-令牌环">#</a> IEEE 802.5 令牌环</h3><p>发送站点抓取环中传输的令牌，获得发送权，从而向环中发送数据帧<br>防无限循环：环上的帧需要由目的站或发送站将其从环上去除<br>数据确认：帧内设置某一比特域，初值为 0，目的站收到后，将其变为 1<br>随着交换以太网的出现和以太网速率不断提高，令牌环技术最终落后于以太网</p><h3 id="自适应树搜索协议"><a class="anchor" href="#自适应树搜索协议">#</a> 自适应树搜索协议</h3><p>将所有站点组织成二叉树结构，在第 1 槽内半数站（2 以下站）参与竞争，如其中之一获得信道，本帧后的时槽留给 3 以下的站，如还冲突则继续折半隔离搜索</p><h3 id="以太网"><a class="anchor" href="#以太网">#</a> 以太网</h3><h4 id="csmacd"><a class="anchor" href="#csmacd">#</a> CSMA/CD</h4><p>当两个帧发生冲突时，两个被损坏帧继续传送毫无意义，而且信道无法被其他站点使用，浪费信道<br>如果侦听到发生冲突，立即停止并发送 Jam（强化）信号，等待一个随机时间再开始侦听<br>冲突窗口 = RTT（往返时延），在这个时间区间内可能侦听到发出的帧遭到冲突 / 碰撞，超出则无法判断<br>帧长要足够，从而在发送一帧的同时，完成该帧的冲突检测<br>以太网规定最短有效帧长为 <strong>64 字节</strong>（10Mbps 以太网最大长度为 2500 米，在最差情况下 RTT 约 50 微秒，能发送 500 bit，约 512 bit）<br>检测到冲突就立即中止发送，这时发送出去的数据一定小于 64 字节，凡长度小于 64 字节的帧都是由于冲突而异常中止的无效帧<br>网速提高：增大最短帧长或者减小站点间距离<br>等待<strong>一段时间</strong>重发？二进制指数后退：<br>确定基本退避时间槽，其长度为以太介质上往返传播时间 (2𝜏) ，以太网中设为 512 比特时间；<br>定义重传次数 k，k = min [重传次数，10]；<br>从整数集合 [0, 1, … , (2^k − 1)] 中随机地取出一个数，记为 r；<br>重传所需的时延就是 r 倍的时间槽 2𝜏；<br>重传达 16 次仍不能成功时即丢弃该帧，并向高层报告</p><h3 id="经典以太网"><a class="anchor" href="#经典以太网">#</a> 经典以太网</h3><p>MAC 帧中的源地址和目的地址长度均为 6 字节<br>目的地址（6）+ 源地址（6）+ 类型（2）+ 数据（46 ～ 1500）+ 校验和（4）<br>数据字段不足 46 字节，需要填充整数字节（Padding）至 46 字节，以保证以太网 MAC 帧不小于 64 字节<br>对于校验和中检查出的无效 MAC 帧就简单地丢弃，以太网不负责重传丢弃的帧</p><h2 id="ch05-02-可扩展的以太网"><a class="anchor" href="#ch05-02-可扩展的以太网">#</a> CH05-02 可扩展的以太网</h2><h3 id="链路层交换原理"><a class="anchor" href="#链路层交换原理">#</a> 链路层交换原理</h3><p>使用集线器（HUB，物理层设备）组建以太网，用集线器组成更大的局域网都在一个<strong>冲突域</strong>中<br>HUB 内部连接所有线缆，逻辑上等同于单根总线的经典以太网，同一个冲突域必须使用 CSMA/CD 协议<br>交换机 Switch：每个端口都有独立的冲突域，在全双工模式下端口可以同时收发，则不需要 CSMA/CD<br>交换机：交换式以太网的核心，工作在<strong>数据链路层</strong>，检查 MAC 帧的目的地址对收到的帧进行转发，通过高速背板把帧传送到目标端口<br>网桥：可以理解为两个端口的交换机，现已经逐渐被交换机取代</p><h4 id="mac-地址表"><a class="anchor" href="#mac-地址表">#</a> MAC 地址表</h4><p>逆向学习源地址，并根据目的地址查询 MAC 地址表<br>地址匹配：如果入境口 = 出境口，则丢弃该数据，否则向指定端口发送<br>找不到匹配表项？从所有端口（除了入境口）发送出去（泛洪）！<br>构建 MAC 地址表：记录帧到达时间，设定老化时间（默认 300s）当老化时间到期时，该表项会被清除；<br>再次受到表中存在的一个 MAC 地址，则更新老化时间。<br>此外，对于广播帧（目的地址为 FF-FF-FF-FF-FF-FF 的数据帧）也需要泛洪</p><h3 id="生成树协议"><a class="anchor" href="#生成树协议">#</a> 生成树协议</h3><h4 id="物理环路的问题"><a class="anchor" href="#物理环路的问题">#</a> 物理环路的问题</h4><p>当一个帧的多个副本到达不同端口时，交换机会不断修改同一 MAC 地址对应的端口<br>X 发送到环路的单播帧，造成目的设备 Y 收到重复的帧<br>交换机（网桥）在物理环路上无休止地泛洪广播流量，无限循环，迅速消耗网络资源</p><h4 id="桥协议数据单元-bpdu"><a class="anchor" href="#桥协议数据单元-bpdu">#</a> 桥协议数据单元 BPDU</h4><p>桥 ID 共 8 字节，由 2 字节的优先级和 6 字节的 MAC 地址组成的<br>BPDU 包含四个关键信息：<br>根桥 ID：被选为根的桥 ID<br>根路径开销：到根桥的最小路径开销<br>指定桥 ID：生成和转发 BPDU 的桥 ID<br>指定端口 ID：发送 BPDU 的端口 ID</p><h4 id="生成树选举"><a class="anchor" href="#生成树选举">#</a> 生成树选举</h4><p>（1）选举根桥，先比较<strong>优先级</strong>数值更小，再比较 <strong>MAC 地址</strong>更小<br>（2）为每个非根桥选出一个根端口，该非根桥使用选出的这个根端口去根桥<br>通过比较其每个端口到根桥的<strong>根路径开销</strong>，再比较<strong>端口 ID</strong>。<br>路径开销？根桥的路径开销为 0，非根桥为到根桥的路径上所有端口（链路）开销之和。<br>（3）为每个网段确定一个指定端口，代表这个网段向其他网段转发数据<br>在所有连接到它的交换机（网桥）端口中进行选择，一个具有最小根路径开销的端口，作为该网段的指定端口；指定端口处于转发状态，负责该网段的数据转发。<br>连接该网段的其他端口，若既不是指定端口，也不是根端口，则阻塞。<br><strong>根桥的所有端口都是指定端口</strong><br>某些交换机如果没有链路经过，可能不会被使用</p><h4 id="源路由网桥"><a class="anchor" href="#源路由网桥">#</a> 源路由网桥</h4><p>生成树协议获得的路径可能不是最佳<br>通过广播 “发现帧” 获得最佳路由，源站若需要定位目的地，则发送 “发现帧”，每个网桥收到后广播；该帧经过网桥时被加上桥标识（接口标识），目的站收到后发应答帧；源站收到后就知道了到目的站的最佳路由</p><h3 id="链路层交换机"><a class="anchor" href="#链路层交换机">#</a> 链路层交换机</h3><p>即插即用网络设备，执行数据链路层交换算法。<br>对称交换：出入带宽相同；非对称交换：出入带宽不同。<br>传统 LAN：交换机端口通常与集线器 HUB 连接；<br>现代 LAN：交换机直接连接 PC，微分段，创建无冲突域</p><h4 id="交换模式"><a class="anchor" href="#交换模式">#</a> 交换模式</h4><p>存储转发：转发前必须接受整个帧，进行 CRC 校验，但<strong>转发延迟极大</strong><br>直通交换：一旦接收到帧的目的地址，就开始转发，延迟非常小，但可能转发错误的帧，且<strong>不支持非对称交换</strong><br>无碎片交换：接收到帧的前 64 字节，即开始转发，减小了错误的几率，但也<strong>不支持非对称交换</strong></p><h3 id="虚拟局域网-vlan"><a class="anchor" href="#虚拟局域网-vlan">#</a> 虚拟局域网 VLAN</h3><p>广播域是广播帧能够到达的范围，默认情况下交换机的所有端口同属于一个广播域<br>VLAN：独立的广播域，交换机根据用途，工作组等划分 VLAN 来隔离广播域<br>VLAN 类型：基于（交换机的）端口；基于（主机的） MAC 地址；基于协议；基于 IP 子网<br>交换机如何区分不同的 VLAN？由交换机在数据帧中添加 / 剥除 VLAN 标记，对终端站点透明</p><p>接入链路（Access）类型端口：连接主机的端口，只能加入一个 VLAN<br>干道（Trunk）类型端口：一般用于交换机之间连接，允许多个 VLAN 的流量通过</p><p>控制广播域范围；增强网络的安全性；提高网络的可管理性。</p><p>VLAN 间用<strong>三层设备</strong>通信。</p><h2 id="mac无线局域网-wlan"><a class="anchor" href="#mac无线局域网-wlan">#</a> MAC：无线局域网 WLAN</h2><h3 id="无线局域网组网模式"><a class="anchor" href="#无线局域网组网模式">#</a> 无线局域网组网模式</h3><p>分布式系统，拥有访问点 AP，站点 STA<br>站点访问需要通过 AP 进行，设备通过 SSID 识别和访问无线网络<br>IBSS 自组织形成无线局域网，站点 STA 之间直接通信，共享同一无线信道</p><h3 id="csmaca-带冲突避免的载波侦听多路访问-ieee-80211"><a class="anchor" href="#csmaca-带冲突避免的载波侦听多路访问-ieee-80211">#</a> CSMA/CA 带冲突避免的载波侦听多路访问 IEEE 802.11</h3><p>有线网络的 CSMA/CD 用于无线网冲突检测困难，且站点不一定能互相感知到信号，导致冲突<br>CSMA/CD 失效的 2 个原因：冲突检测困难，无线传输范围<br>所有站点完成发送后，必须等待一段很短的时间才能发送下一帧。这段时间通称为帧间间隔或帧间隙 (IFS，Inter-Frame Space)。<br>采用停等机制：发送数据，等待确认，超时重传（重传定时器）（停等简单且网络 RTT 小）</p><h4 id="算法"><a class="anchor" href="#算法">#</a> 算法</h4><p>信道空闲时间大于 IFS 时，立即传输；<br>当侦听到信道忙时，延迟到当前传输结束 + IFS 时间后，开始随机退后：从 (0, CWindow) 中随机选择一个作为退后计数器，持续侦听时间槽，如果空闲则减少退后时间，如果信道忙则挂起退后过程知道当前信道的传输结束</p><p>目标：当网络负载轻时，减小站点等待时间；当网络负载重时，避免太多的冲突。</p><h4 id="cwindow-选取"><a class="anchor" href="#cwindow-选取">#</a> CWindow 选取</h4><p>二进制指数退后算法<br>竞争窗口的初始值为某个最小值，发生冲突时加大窗口，直到达到最大值<br>竞争窗口的选择应与网络负载情况相适应</p><h4 id="帧间隙控制优先级"><a class="anchor" href="#帧间隙控制优先级">#</a> 帧间隙控制优先级</h4><p>SIFS（Short IFS）：最高优先级，用于 Ack, CTS, 轮询响应等<br>PIFS（点协调功能 DCF IFS）：中等优先级（ SIFS+1 槽口时间），轮询服务<br>DIFS（分布式协调 DCF IFS）：最低优先级（ SIFS+2 槽口时间），异步数据服务</p><h4 id="rts-cts-机制"><a class="anchor" href="#rts-cts-机制">#</a> RTS-CTS 机制</h4><p>隐藏终端问题：由于距离太远（或障碍物）导致站点无法检测到竞争对手的存在<br>隐藏站点不能侦听到发送端但能干扰接收端<br>暴露终端问题：由于侦听到其他站点的发送而误以为信道忙导致不能发送<br>暴露站点能侦听到发送端但不会干扰接收端</p><p>目的：通过信道预约，避免数据帧 (长帧) 冲突<br>发送端发送 RTS，接收端回送 CTS，之间的持续时间中指明传输所需时间（数据 + 控制）；其他相关站点能够收到 RTS 或（和）CTS，维护 NAV（Network Allocation Vector）；从而隐藏站点因为收到 CTS 而保持静默，暴露站点只收到 RTS 而未收到 CTS 也不能发送，因为会干扰站点对 CTS 和 ack 的接收。</p><h4 id="帧格式"><a class="anchor" href="#帧格式">#</a> 帧格式</h4><p>帧控制，持续时间，<strong>地址 1 ～ 4</strong><br>地址 1（物理接收者），地址 2（物理发送者），地址 3/4（逻辑收发者）<br>地址域段使用见 CH08-02 P72，地址 4 只有在 AP 到 AP 时起作用，此时地址 3 是目的地址，4 是源地址。<br>BSSID：基本服务集标识符，为 AP 的 MAC 地址</p><h2 id="ch06-01-网络层基础"><a class="anchor" href="#ch06-01-网络层基础">#</a> CH06-01 网络层基础</h2><h3 id="ip-地址"><a class="anchor" href="#ip-地址">#</a> IP 地址</h3><p>又称逻辑地址，网络上的每一台主机（或路由器）的每一个接口都会分配一个全球唯一的 32 位的标识符<br>划分为：网络地址和网络中的主机地址，每个网络中的主机数量不同，地址数量不同</p><p>A 类：第一位为 0，8 位网络地址，24 位主机地址<br>B 类：前两位 10，16 位网络地址，16 位主机地址<br>C 类：前三位 110，24 位网络地址，8 位主机地址<br>D 类：前四位 1110，多播地址<br>E 类：前四位 1111<br>A 类、B 类、C 类为单播地址</p><p>CLDR 无类域间路由：<br>将 32 位的 IP 地址划分为前后两个部分，并采用斜线记法，即在 IP 地址后加上 “/”，然后再写上网络前缀所占位数，如 172.16.2.160/26</p><p>子网划分 (subnetting)，在网络内部将一个网络块进行划分以供多个内部网络使用，对外仍是一个网络<br>子网掩码 (subnet mask)，与 IP 地址一一对应，是 32 bit 的二进制数，置 1 表示网络位，置 0 表示主机位（网络位 = 网络号 + 子网号）</p><p>主机位全为 0：代表子网的地址；主机位全为 1：代表广播的地址<br>因此可分配的 IP 地址范围要除去主机位全为 0 或 1（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2^n-2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.747722em;vertical-align:-.08333em"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.664392em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span></span></span></span>）。</p><p>最长前缀匹配：IP 地址与 IP 前缀（子网掩码取与）匹配时，总是选取<strong>子网掩码最长</strong>的匹配项。</p><p>路由环路问题：设置计数器 TTL 解决。</p><p>IPv4 数据报格式：见 PPT<br>IP 协议两个基本功能<br>・编址 (addressing)<br>・分片 (fragmentation)<br>数据报分片：设置 MF 和 DF 标志，DF 表示是否允许分片（只有为 0 时才能分片），MF 表示是否是最后一个分片（是位 0，不是为 1），以及片偏移位，单位为字节。<br>（最大帧长 1518 B）</p><p>广播：采用广播地址；<br>组播：发送给某些个别用户；<br>选播：将数据包传送给最近的一个组成员，例如 DNS 服务器，没有指定情况下总是连接到最近的服务器。</p><h3 id="网络层基础协议"><a class="anchor" href="#网络层基础协议">#</a> 网络层基础协议</h3><p>公有 IP 地址逐级分配<br>路由器、服务器等申请固定 IP 地址或手工设定<br>主机通过 DHCP 协议动态配置 IP 地址</p><h4 id="dhcp-动态主机配置协议"><a class="anchor" href="#dhcp-动态主机配置协议">#</a> DHCP 动态主机配置协议</h4><p>当主机加入 IP 网络，允许主机从 DHCP 服务器动态获取 IP 地址（C/S 模式）<br>基于 <strong>UDP</strong> 工作，服务器运行在 67 号端口， 客户端运行在 68 号端口<br>四个阶段：discover，offer，request，ack<br>Discover：源为 PC 机的 MAC，目标 MAC 为全 FF，源 IP 为 0.0.0.0，目标 IP 为 255.255.255.255（广播）<br>Offer：源为 DHCP 服务器的 MAC，目标 MAC 为客户机的 MAC，源 IP 为 DHCP 服务器的 IP，目标 IP 为 255.255.255.255（单播）<br>Request 和 Ack 同上<br>DHCP 服务不只返回客户机所需的 IP 地址，还包括：缺省路由器 IP 地址、DNS 服务器 IP 地址、网络掩码。</p><h4 id="arp-地址解析协议"><a class="anchor" href="#arp-地址解析协议">#</a> ARP 地址解析协议</h4><p>MAC 头部中的源和目的地址是本端口硬件地址和下一个（路由器）端口的硬件地址，而 IP 头则直接是真正发送和接收的 IP 地址。<br>在 ARP 表中缓存 IP 地址和 MAC 地址的映射关系（即 ARP 高速缓存）<br>主机 A 广播发送 ARP 请求分组；主机 B 向 A 单播发送 ARP 响应分组。</p><p>与目的主机在同一个 IP 子网内：直接查表交付 MAC 地址；<br>与目的主机不在同一个 IP 子网内：间接交付，源不知道目的的 MAC 地址</p><p>要发送数据包时，先找到路由器的 IP 地址（查找路由表），之后再找到 MAC 地址（ARP）。</p><h4 id="icmp-互联网控制报文协议"><a class="anchor" href="#icmp-互联网控制报文协议">#</a> ICMP 互联网控制报文协议</h4><p>报文携带在 IP 数据报中<br>允许主机或路由器报告差错情况和提供有关异常情况的报告<br>前 4 个字节包含格式统一的三个字段：类型、代码、检验和<br>类型表见网络或 CH06-01 P57<br>PING 用来测试两个主机之间的连通性<br>TraceRT/Traceroute 知道整个路径上路由器的地址。</p><h2 id="ch06-02-网络层路由协议"><a class="anchor" href="#ch06-02-网络层路由协议">#</a> CH06-02 网络层：路由协议</h2><h3 id="距离向量算法和-rip"><a class="anchor" href="#距离向量算法和-rip">#</a> 距离向量算法和 RIP</h3><p>基于 <strong>UDP</strong> 协议，520 端口。</p><h4 id="原理"><a class="anchor" href="#原理">#</a> 原理</h4><p>路由器刚开始工作时，只知道直接连接的网络的距离，接着每一个路由器也只和数目非常有限的相邻路由器交换并更新路由信息。经过若干次更新后，所有路由器最终都会知道到达本自治系统任何一个网络的最短距离和下一跳路由器的地址，即 “收敛”。</p><p>RIP 允许一条路由最多只能包含 15 个路由器，因此距离为 16 表示<strong>网络不可达</strong>。</p><p>通过周期性更新（30s），解决可靠性和动态性问题。<br>仅适合中小型网络</p><h4 id="算法-2"><a class="anchor" href="#算法-2">#</a> 算法</h4><ol><li>修改相邻路由器发来的 RIP 报文中所有表项，对地址为 X 的相邻路由器发来的 RIP 报文，修改此报文中的所有项目：把 “下一跳” 字段中的地址改为 X ，并把所有的 “距离” 字段 +1。</li><li>对修改后的 RIP 报文中的每一个项目，进行以下步骤：（1）路由表中若没有 Net，则把该项目填入路由表（2）路由表中若有 Net ，则查看下一跳路由器地址：若下一跳是 X，则用收到的项目替换源路由表中的项目；若下一跳不是 X，原来距离比从 X 走的<strong>距离远</strong>则更新，否则不作处理。</li><li>若 180s 还没收到相邻路由器 X 的更新路由表，则把 X 记为不可达的路由器，即把距离设置为 16。</li></ol><p>好消息传的快，坏消息传的慢！<br><strong>水平分裂算法</strong>：邻居学到的路由不向邻居节点通告；<br><strong>毒性逆转</strong>：邻居学到的路由用不可达距离 16 广播。<br>用于消除路由循环</p><h3 id="链路状态算法和-ospf"><a class="anchor" href="#链路状态算法和-ospf">#</a> 链路状态算法和 OSPF</h3><p>基于 IP，协议号 89</p><h4 id="算法-3"><a class="anchor" href="#算法-3">#</a> 算法</h4><ol><li>每个路由器发现它的邻居结点【 HELLO 问候分组】，并了解邻居节点的网络地址。</li><li>设置到它的每个邻居的成本度量 metric。</li><li>构造【 DD 数据库描述分组】，向邻站给出自己的链路状态数据库中的所有链路状态项目的 ** 摘要（头部）** 信息。</li><li>如果 DD 分组中的摘要自己都有，则邻站不做处理；如果有没有的或者是更新的，则发送【 LSR 链路状态请求分组】请求自己没有的和比自己更新的信息。</li><li>收到邻站的 LSR 分组后，发送【 LSU 链路状态更新分组】进行更新。</li><li>更新完毕后，邻站返回一个【 LSAck 链路状态确认分组】进行确认。<br>只要一个路由器的链路状态发生变化：</li><li>泛洪发送【 LSU 链路状态更新分组】进行更新。</li><li>更新完毕后，其他站返回一个【 LSAck 链路状态确认分组】进行确认。</li><li>使用 Dijkstra 根据自己的链路状态数据库 LSDB 构造到其他节点间的最短路径。</li></ol><p>各路由器间交换链路状态信息，使得所有路由器最终都能建立链路状态数据库 LSDB，其交互过程称为链路状态数据库的同步；LSDB 构成网络拓扑结构图，它在区域内是一致的。</p><p>划分区域：主干，非主干<br>区域边界路由器 ABR</p><h4 id="对比"><a class="anchor" href="#对比">#</a> 对比</h4><p>・RIP - 距离向量 DV ：将世界的（最佳）信息告诉邻居，适用范围小，收敛速度慢，基于 UDP；<br>・OSPF - 链路状态 LS ：将自己的信息通过邻居告诉世界，适用大中型网络，但计算量大，协议复杂，基于 IP。</p><h3 id="层次路由和域间路由协议-bgp"><a class="anchor" href="#层次路由和域间路由协议-bgp">#</a> 层次路由和域间路由协议 BGP</h3><h4 id="地址聚合"><a class="anchor" href="#地址聚合">#</a> 地址聚合</h4><p>最长相同前缀，其余补零。减少路由表存储空间。</p><h4 id="bgp-外部网关路由协议"><a class="anchor" href="#bgp-外部网关路由协议">#</a> BGP 外部网关路由协议</h4><p>自治系统 AS，自治系统边界路由器 ASBR，从距离向量升级为路径向量；<br>eBGP：从相邻的 AS 获得网络可达信息；iBGP： 将网络可达信息传播给 AS 内的路由器</p><p>BGP 计算路由的基础是自治系统数目<br>・路径向量（X：AS1, AS2, AS3；距离 3）<br>・在 BGP 启动时，BGP 与邻居交换整个 BGP 路由表，以后只更新有变化的部分<br>・BGP 通过 <strong>TCP</strong> 的 179 端口交换报文，实现路由信息传输的可靠性</p><p>在接收路由时，设备如果发现路径向量列表中有本 AS 号，则不接收该路由，从而<strong>避免了 AS 间的路由环路</strong>。</p><p>最佳路由选择规则<br>・本地偏好值属性：政策决策<br>・最短的 AS-PATH<br>・最近的 NEXT-HOP 路由器<br>・附加标准…<br>・最低路由器 ID</p><p>路由器使用策略决定接受或拒绝接收到的路由通告，路由器也会基于策略决定是否向其他相邻 AS 通告路径信息（不向提供者通告用户间的服务等）</p><h2 id="ch06-03-网络层进阶"><a class="anchor" href="#ch06-03-网络层进阶">#</a> CH06-03 网络层进阶</h2><h3 id="虚电路转发策略"><a class="anchor" href="#虚电路转发策略">#</a> 虚电路转发策略</h3><p>一条源主机到目的地的主机类似于电路的路径（逻辑连接），路径上所有结点都要维持这条虚电路的建立，都维持一张虚电路表，每一项记录了一个打开的虚电路的信息。</p><p>虚电路方式为网络层提供连接服务。源节点与目的结点之间建立一条逻辑连接，而非实际物理连接。首先为分组的传输确定传输路径（建立连接），然后沿该路径（连接）传输系列分组，系列分组传输路径相同，传输结束后拆除连接。</p><p>一次通信的所有分组都通过虚电路顺序传送，分组不需携带源地址、目的、地址等信息，包含虚电路号，相对数据报方式开销小，同一报文的不同分组到达目的结点时不会乱序、重复或丢失。</p><p>每个节点可能与多个节点之间建立多条虚电路，每条虚电路支持特定的两个端系统之间的数据传输，可以对两个数据端点的流量进行控制，两个端系统之间也可以有多条虚电路为不同的进程服务。</p><p>致命弱点：当网络中的某个结点或某条链路出故障而彻底失效时，则所有经过该结点或该链路的虚电路将遭破坏。</p><h3 id="多协议标签交换-mpls"><a class="anchor" href="#多协议标签交换-mpls">#</a> 多协议标签交换 MPLS</h3><p>MPLS 网络的基本组成单元是标签交换路由器 LSR（Label Switching Router）。</p><p>MPLS 标签是一个短而定长的、只具有本地意义的标识符，用于唯一标识一个分组所属的 FEC。标签封装在链路层和网络层之间。这样，标签能够被任意的链路层所支持。</p><p>在 MPLS 域的入口处，给每一个 IP 数据报加上标签，然后对加上标记的 IP 数据报用<strong>硬件</strong>进行转发。当分组离开 MPLS 域时，MPLS 出口路由器把分组的标签去除。后续按照一般 IP 分组的转发方法进行转发</p><p>在以太网的帧首部和 IP 数据报的首部之间插入一个 4 字节的 MPLS 首部，“2.5 层协议 &quot;</p><p>面向连接，更强控制</p><h3 id="路由器体系结构"><a class="anchor" href="#路由器体系结构">#</a> 路由器体系结构</h3><h4 id="路由器控制平面"><a class="anchor" href="#路由器控制平面">#</a> 路由器控制平面</h4><p>软件路由管理，根据路由优先级形成核心路由表，主控板运行多个路由协议。</p><p>核心路由表下发到接口板的（硬件）数据面，形成转发表（FIB）。</p><h4 id="路由器数据平面"><a class="anchor" href="#路由器数据平面">#</a> 路由器数据平面</h4><p>硬件维护转发表和转发引擎，通过接口卡进行链路层解封装，转发表查询，通过不同类型的交换结构从输入接口卡发往输出接口卡，进行链路层封装和发送。</p><p>路由器系统包含完整 TCP/IP 协议栈，也包含部分传输层和应用层协议。</p><h3 id="nat-技术"><a class="anchor" href="#nat-技术">#</a> NAT 技术</h3><p>网络地址转换，允许对内部网络（内网）实行私有编址，从而维护合法注册的公有全局编址方案，并节省 IP 地址。通过 TCP/UDP 16 个 bit 的端口号机制使得一个 WAN 侧地址可支持 &gt; 60,000 个并行连接。</p><p>通过 NAT 转换表，可以将广域网地址及其端口转换为局域网地址及端口。</p><p>能够节省合法地址，减少地址冲突；灵活连接 Internet；保护局域网的私密性。</p><p>NAT 作为<strong>路由器处理传输层</strong>协议，违反了最基本的协议分层规则，违反了端到端的原则，违反了 IP 的结构模型。</p><h3 id="ipv6-协议"><a class="anchor" href="#ipv6-协议">#</a> IPv6 协议</h3><p>IPv6 头部长度固定 40 字节，所有 “选项” 字段都在 IPv6 扩展头部分。去除了首部长度字段和首部校验和字段，提升转发速度。IPv6 报文可承载多个扩展头，每个扩展头都包含 “下一个首部” 字段。</p><p>IPv6 分组不能在传输途中分片，只在源端进行分片；去除分片字段：“标识”“标志”“片偏移”，移至扩展头（分段头）。</p><p>路由协议的修改，ND 协议，替代 ARP 进行单跳网络管理。</p><p>回环地址（::1/128），表示节点自己，不分配，类似 IPv4 中的 127.0.0.1<br>组播地址（FF00::/8）<br>链路本地地址（FE80::/10），也称为 Link-local 地址，仅在本地链路上使用，网络设备根据接口 MAC 地址自动生成</p><h4 id="协议迁移"><a class="anchor" href="#协议迁移">#</a> 协议迁移</h4><p>协议的翻译，形式化系统相互转换；隧道技术，相互承载，广泛使用。</p><p>隧道技术：将 A 协议数据包封装在 B 协议中传输，支持路径 MTU（Path MTU）发现机制，在路径中多个链路中发现最小的 MTU。</p><h3 id="服务质量与拥塞控制"><a class="anchor" href="#服务质量与拥塞控制">#</a> 服务质量与拥塞控制</h3><p>突发流量 &lt;-&gt; 流量整形<br>缺少差异化服务 &lt;-&gt; 综合服务、区分服务<br>流量超出带宽 &lt;-&gt; 拥塞控制</p><h4 id="流量整形"><a class="anchor" href="#流量整形">#</a> 流量整形</h4><p>限制流出某一网络的某一连接的流量与突发，使这类报文以比较均匀的速度向外发送。</p><p>漏桶算法，拥有最多排队字节，数据包从漏桶中漏出，以常量速率注入网络；</p><p>令牌桶算法，周期性以常量速率增加令牌，令牌数有上限，数据包大小与消耗令牌数成正相关，当令牌数量可以满足数据包对令牌的需求则输出，否则将数据包丢弃。</p><h4 id="综合服务-intserv"><a class="anchor" href="#综合服务-intserv">#</a> 综合服务 IntServ</h4><p>基于资源预留协议 RSVP，面向连接逐节点建立和拆除流的状态和资源预留状态，根据流的状态进行 QoS 路由。</p><p>资源预分配、全局流状态、传输控制。</p><h4 id="区分服务-diffserv"><a class="anchor" href="#区分服务-diffserv">#</a> 区分服务 DiffServ</h4><p>使用类而不是流，针对每个类别实现不同服务质量。</p><p>IPv6 报头的 8 位区分服务 DS 字段使用六位进行分组分类。</p><h4 id="服务质量路由-qosr"><a class="anchor" href="#服务质量路由-qosr">#</a> 服务质量路由 QoSR</h4><p>绕开热门的区域疏散流量。</p><p>通过抑制包（路由器选择被拥塞数据包给源主机返回抑制包，通知减少发送）、逐跳的抑制包（不需要源主机响应，而是对经过的每个路由器都起作用，但要求上游路由器有更大的缓冲区）、显式拥塞通告 ECN（在 IP 包头中记录数据包是否经历了拥塞，接收方在下一个应答数据包回显这个标记作为显式拥塞信号）进行流量调节。</p><p>未雨绸缪缓解拥塞：随机早期检测 RED，将路由器到达队列划分为丢弃，以概率 p 丢弃，排队三个区域，最小门限为排队长度，最大门限加上概率 p 丢弃长度，平均队列长度为期望。</p><h2 id="ch07-01-传输层基础"><a class="anchor" href="#ch07-01-传输层基础">#</a> CH07-01 传输层基础</h2><h3 id="传输层服务复用与分用"><a class="anchor" href="#传输层服务复用与分用">#</a> 传输层服务：复用与分用</h3><p>发送端复用：传输层从多个应用收集数据，交给网络层发送<br>接收端分用：传输层将从网络层收到的数据，交付给正确的应用</p><p>进程标识：需要在传输层头（段头）增加信息</p><h3 id="udp-协议"><a class="anchor" href="#udp-协议">#</a> UDP 协议</h3><p>只在 IP 服务上增加复用与分用和差错检验功能<br>只提供不可靠的交付</p><p>面向报文的协议</p><p>用户数据报 UDP 有两个字段：数据字段 + 8 个字节的首部字段，之前是 12 个字节的 IPv4 伪头部</p><p>不需要建立连接，不限制发送速率，对应用层交下来的报文，既不合并，也不拆分，而是<strong>保留这些报文的边界</strong></p><h3 id="tcp-协议"><a class="anchor" href="#tcp-协议">#</a> TCP 协议</h3><p>每一条 TCP 连接只能有两个端点</p><p>面向字节流，TCP 中的 “流” 指的是流入或流出进程的字节序列，TCP 把应用程序交下来的数据看成仅仅是一连串无结构的字节流<br>不关心应用进程一次把多长的报文发送到 TCP 缓存，对连续的字节流进行分段，形成 TCP 报文段<br>端到端之间<strong>不保留消息边界</strong>，不能认为一个用户消息对应一个 TCP 报文<br>如何知道消息边界？固定长度的消息；特殊字符作为边界；自定义消息结构。</p><p>TCP 连接的端点叫做套接字 (socket) 或插口，根据 RFC 793 的定义：端口号拼接到 IP 地址即构成了套接字。</p><p>建立连接：三次握手<br>CONNECT / SYN (SEQ = x)<br>SYN / SYN + ACK (SEQ = y, ACK = x + 1)<br>SYN + ACK / ACK (SEQ = x + 1, ACK = y + 1)</p><p>释放连接：四次挥手，TCP 连接是全双工的，因此，每个方向都必须要单独进行关闭</p><p>第一次挥手：Client 端发起挥手请求，向 Server 端发送标志位是 FIN 报文段，设置序列号 seq，此时，Client 端进入 FIN_WAIT_1 状态，这表示 Client 端没有数据要发送给 Server 端了。<br>第二次分手：Server 返回一个标志位是 ACK 的报文段，ack 设为 seq + 1，Client 端进入 FIN_WAIT_2 状态，Server 端告诉 Client 端，我确认并同意你的关闭请求。<br>第三次分手：Server 端向 Client 端发送标志位是 FIN 的报文段，请求关闭连接，同时 Client 端进入 LAST_ACK 状态。<br>第四次分手：Client 端向 Server 端发送标志位是 ACK 的报文段，然后 Client 端进入 TIME_WAIT 状态。Server 端收到 Client 端的 ACK 报文段以后，就关闭连接。此时，Client 端等待 2MSL 的时间后依然没有收到回复，则证明 Server 端已正常关闭，那好，Client 端也可以关闭连接了。</p><p>MSL：文段最大生存时间，它是任何报文段被丢弃前在网络内的最长时间。<br>等待 2MSL 的原因：保证 TCP 协议的全双工连接能够可靠关闭，因为 Server 可能因为没有收到 ACK 而重发 FIN；保证这次连接的重复数据段从网络中消失，避免建立新链接收到脏数据。</p><p>TCP 段最大净载荷：65535-20（TCP 头）-20（IP 头）=65495</p><h3 id="拥塞控制"><a class="anchor" href="#拥塞控制">#</a> 拥塞控制</h3><p>每个端口输出队列的简化视图<br>・通常为 FIFO（先进先出），装满后将其丢弃<br>・当 短暂发生 输入 &gt; 输出 速率时，利用队列吸收突发到来的分组<br>・但是如果 输入 &gt; 输出 速率持续存在，队列将溢出，即发生拥塞<br>要避免出现上述情况：在拥塞变严重前就降低发送速率</p><p>最大 - 最小公平分配：</p><ol><li>所有流量从速率为 0 开始</li><li>增加流量，直到网络中出现新的瓶颈</li><li>固定瓶颈流量的速率</li><li>转到步骤 2，查看是否有剩余流量</li></ol><p>发送窗口 = min (拥塞窗口，流控窗口)，根据网络状态调整窗口大小，发送速率与网络带宽匹配</p><p><strong>慢启动</strong>：拥塞窗口 cwnd 对 RTT 呈指数增长<br>即在双方建立逻辑链接关系时， 拥塞窗口 cwnd 的值被设置为 1，还需设置慢开始门限 ssthresh，在执行慢开始算法时，发送方每收到一个对新报文段的确认时，就把拥塞窗口 cwnd 的值加一，然后开始下一轮的传输，当拥塞窗口 cwnd 增长到慢开始门限值时，就使用拥塞避免算法。<br><strong>拥塞避免</strong>：一旦慢启动超过阈值，TCP 从慢启动切换到线性增加状态，每个传输轮次，拥塞窗口 cwnd 只能线性加一。<br>发生<strong>确认超时</strong>后，阈值降为当前拥塞窗口的一半（窗口也降为一半（Reno）/ 降为 0（Tahoe）），然后重新启动。</p><p>带宽公平分配的 AIMD 原理：<br>・加性增加：连接 1 和连接 2 按照相同速率增大各自的拥塞窗口，得到斜率为 1 的直线<br>・乘性减少：连接 1 和连接 2 将各自的拥塞窗口减半</p><p><strong>快重传</strong>：使发送方尽快进行重传，要求接收方不要等待自己发送数据时捎带确认，而是立即发送确认；报文如果失序则发送重复确认；一旦收到三个连续的重复确认则立即重传。<br><strong>快恢复</strong>：将 ssthresh 与 cwnd 调整为窗口的一半（+ 3），之后线性增长。</p><h3 id="计时器"><a class="anchor" href="#计时器">#</a> 计时器</h3><h4 id="超时定时器"><a class="anchor" href="#超时定时器">#</a> 超时定时器</h4><p>由于 TCP 的下层是互联网环境，发送的报文段可能只经过一个高速率的局域网，也可能经过多个低速率的网络，并且每个 IP 数据报所选择的路由还可能不同。如果把超时重传时间设置得太短，就会引起很多报文段的必须要的重传，使网络负荷增大。但若把超时重传时间设置的过长，则又使网络的空闲时间增大，减低了传输效率。</p><p>TCP 采用了一种自适应算法，它记录一个报文段发出的时间，以及收到相应的确认的时间。这两个时间之差就是报文段的往返时间 RTT。</p><p>新的 SRTT = (1 - α) x (旧的 RTTs) + α x (新的 RTT 样本)<br>RTT：报文段往返时间<br>RTTs：加权平均往返时间 α： 0 ≤ α &lt; 1，RFC 6298 推荐的 α 值为 1/8，即 0.125</p><p>新的 RTTD = (1 - β) x (旧的 RTTD) + β x | SRTT - 新的 RTT 样本 |<br>β：小于 1 的系数，推荐值是 1/4，即 0.25</p><p>RTO = RTTs + 4 x RTTD<br>RTO：超时重传时间<br>RTTD：RTT 的偏差的加权平均值</p><p>整体思想就是结合平均值（就是基本方法）和平均偏差来进行估算。</p><h4 id="持续计时器"><a class="anchor" href="#持续计时器">#</a> 持续计时器</h4><p>当 TCP 连接的一方收到零窗口通知的一方，就启动持续计时器。若持续计时器设置的时间到期，就发送一个零窗口探测报文段（仅携带 1 字节的数据），然后根据对方回复的确认报文段中给出的窗口值进行判断。如果窗口值仍为零，那么收到这个确认报文段的一方就重置持续计时器，轮询发送零窗口探测报文段；如果窗口值不为零，那么死锁的僵局可以打破了，从而可以继续发送数据。</p><h4 id="保活计时器"><a class="anchor" href="#保活计时器">#</a> 保活计时器</h4><p>在一条 TCP 连接中，通信双方长时间没有数据传输的情况下，检测对端是否还活着。</p><p>客户主机正常运行且可达：服务器每收到一次客户的数据，就重置保活计时器，时间的设置默认是 2 小时。<br>客户主机崩溃：若在保活计时器设置的超时时间到期后，仍没有收到客户的数据，服务器就发送一个探测报文段，以后每隔 75 秒发送一次。若一连重试 10 次后仍无客户端的响应，服务器就认为客户端出了故障，接着就关闭该 TCP 连接。<br>客户主机崩溃并重新启动：这时服务器将收到一个对其保活探测报文段的确认，但是这个确认是一个复位 (RST=1)，使得服务器主动终止该 TCP 连接。<br>客户主机正常运行但不可达：同第二种情况一样的处理。</p><h2 id="ch07-02-传输层进阶"><a class="anchor" href="#ch07-02-传输层进阶">#</a> CH07-02 传输层进阶</h2><p>在 Reno 版本的拥塞控制下，进入拥塞避免状态或快速恢复状态后，每经过一个 RTT 才会将窗口大小加 1，假设链路状况好，但 RTT 很长，Reno 要很长时间才能达到最佳拥塞窗口。</p><h3 id="bic"><a class="anchor" href="#bic">#</a> BIC</h3><p>实现步骤：<br>如果发送丢包的时候窗口大小为 W1，此时将窗口减到 W2，在 W2 ~ W1 区间内进行二分搜索，寻找最大的值；<br>当 Wmax 发生更新，则以先慢后快的方式探测 Wmax<br><strong>带宽不公平性</strong>：BIC 以 ACK 时钟驱动拥塞窗口的更新，RTT 较短的连接会更快到达满载窗口，占据<br>更多的带宽，产生不公平性问题</p><h3 id="cubic"><a class="anchor" href="#cubic">#</a> CUBIC</h3><p>用三次函数拟合 BIC 算法曲线，使用绝对时间而不是 RTT 间隔，拥塞窗口成为距上次丢包的时间 t 的函数<br>・Steady State Behavior 阶段：以上凸函数增长逼近最近一次丢包时窗口<br>・Max probing 阶段：以下凸函数增长探测当前满载窗口</p><h3 id="拥塞与瓶颈链路带宽"><a class="anchor" href="#拥塞与瓶颈链路带宽">#</a> 拥塞与瓶颈链路带宽</h3><p>瓶颈链路带宽 BtlBw—— 不会引起路由器缓存排队的最大发送速率<br>RTprop：最小往返时间（传播）<br>带宽时延积：BDP = BtlBw * RTprop<br>・要测最低延迟 RTprop ，就要保证链路队列为空，网络中分组越少越好，cwnd 较小<br>・要测最大带宽 BtlBw ，就要把瓶颈链路填满，此时 buffer 中存在排队分组，延迟较高</p><h3 id="bbr"><a class="anchor" href="#bbr">#</a> BBR</h3><p>启动阶段（START_UP）<br>・当连接建立时，类似 TCP 的慢启动<br>・指数增加发送速率，尽可能快地占满管道<br>・若经过三次窗口增长，发现投递率不再增长，说明已达到最大带宽 BtlBw<br>・瓶颈链路处分组已开始排队（事实上此时占的是三倍 BDP）<br>排空阶段（DRAIN）<br>・指数降低发送速率（相当于是 startup 的逆过程），将多占的两倍 buffer 慢慢排空<br>瓶颈带宽探测（PROBE_BW）<br>・Probe Bandwidth 是四个状态中唯一的稳态，也是持续时间最长的状态 (大概 98% 的时间)<br>・BBR 定义了一个增益循环 (gain cycling) 的概念，一个 cycle 包含 8 个 phase，每个 phase 的持续时间为 1 个 <strong>minRTT</strong>。8 个 phase 的 gain 分别为：1.25、0.75、1、1、1、1、1、1<br>・BBR 一脚油门一脚刹车的组合保证了当链路带宽不变时，这条流不会向链路灌入超量的报文。而 6/8 时间段里的 gain 为 1 又使得大部分时候，采用 BBR 控制的 流发送报文的 pacing rate 是稳定的<br>时延探测（PROBE_RTT）<br>・如果 <strong>minRTT</strong> 在 10s 内没有刷新，则无论之前在哪个状态，BBR 都会强制将流的状态切换到 Probe_RTT<br>・进入 Probe RTT 状态后，BBR 会将 cwnd 限制到一个非常小的值 (4)，并持续至少 200ms, 目的是保证这条流不会引起中间设备上的报文堆积</p><h3 id="quic"><a class="anchor" href="#quic">#</a> QUIC</h3><p>TCP 传输多流复用队头阻塞问题严重。<br>TCP 实现在操作系统内核中，互联网公司作为传输优化的最终受益者，应用难以对 TCP 进行优化和调整。<br>TCP 体系握手时延大，TLS (传输层安全性协议)+TCP 的体系握手时延很大，传输前需要 3 个 RTT 进行握手。</p><p>QUIC 替代 TCP、TLS 和部分 HTTP 的功能，底层基于 UDP 实现，拥塞控制是模块化的，可以方便地使用各种 TCP 拥塞控制算法，如 Cubic 等。</p><h4 id="连接建立时延优化"><a class="anchor" href="#连接建立时延优化">#</a> 连接建立时延优化</h4><p>数据随密钥同时发送，建连仅需 1RTT。</p><h4 id="优化重传"><a class="anchor" href="#优化重传">#</a> 优化重传</h4><p>TCP 的重传包使用和原包相同的序号，因此可能某一序号被用了不止一次。<br>QUIC 的 packet number 单调递增，对于重传包也会递增 packet number，避免 RTO。<br>QUIC 接收端记录收到包与发出 ACK 之间的时延，并发馈给发送端，方便发送端更准确地测量 RTT。</p><h4 id="移动切换连接管理"><a class="anchor" href="#移动切换连接管理">#</a> 移动切换连接管理</h4><p>使用 Connection ID 来表示每个连接，IP 地址或端口的变化不影响对原有连接的识别。</p><h4 id="独立子流减轻队头阻塞"><a class="anchor" href="#独立子流减轻队头阻塞">#</a> 独立子流减轻队头阻塞</h4><p>TCP 多流复用时，某个数据流的数据包丢失，会使得 TCP 连接上所有数据流都需要等待。<br>建立相互独立的多个子流，某子流数据包丢失不影响其它子流数据交付。</p><h3 id="mptcp"><a class="anchor" href="#mptcp">#</a> MPTCP</h3><p>MPTCP 位于套接字和 TCP 之间，MPTCP 可在源主机和目的主机的多对网络接口间<br>分别建立 TCP 连接，将数据流分配到多条 TCP 连接上传输。<br>・路径：主机之间的路径使用四元组表示 &lt;本地 IP 地址，本地端口，远程 IP 地址，远程端口&gt;<br>・子流：在单个路径上运行的 TCP 流称为子流，是 MPTCP 连接的组成部分</p><p>用于 MPTCP 连接管理的新字段<br>・MP_CAPABLE：建立 MPTCP 连接<br>・ADD_ADDR：新增可用路径<br>・REMOVE_ADDR：删除路径<br>・MP_FASTCLOSE：关闭所有子流<br>・MP_JOIN：附加新的子流到已有连接</p><p>MPTCP 根据拥塞窗口大小及路径延迟，将数据按比例分配给各个子流，尽力保证数据包按序到达接收端，降低数据乱序到达对网络性能产生的不利影响。</p><h2 id="ch08-01-应用层"><a class="anchor" href="#ch08-01-应用层">#</a> CH08-01 应用层</h2><h3 id="应用层概述"><a class="anchor" href="#应用层概述">#</a> 应用层概述</h3><p>两台主机通信实际是其上对应的两个应用进程（process）在通信</p><p>客户 / 服务器（C/S, Client/Server）方式<br>浏览器 / 服务器（B/S，Browser/Server） 方式<br>对等（P2P，Peer to Peer）方式</p><h4 id="cs"><a class="anchor" href="#cs">#</a> C/S</h4><p>客户是服务请求方（主动请求服务，被服务），服务器是服务提供方（被动接受服务请求，提供服务）<br>C/S 方式可以是面向连接的，也可以是无连接的。面向连接时，C/S 通信关系一旦建立，通信就是双向的，双方地位平等，都可发送和接收数据。</p><h4 id="bs"><a class="anchor" href="#bs">#</a> B/S</h4><p>B/S 方式采取浏览器请求、服务器响应的工作模式。<br>在 B/S 方式下，用户界面完全通过 Web 浏览器实现，一部分事务逻辑在前端实现，但主要的事务逻辑在服务器端实现。<br>界面统一，使用简单；易于维护；可扩展性好；信息共享度高。</p><h4 id="p2p"><a class="anchor" href="#p2p">#</a> P2P</h4><p>两个进程在通信时并不区分服务的请求方和服务的提供方</p><h4 id="服务器进程工作方式"><a class="anchor" href="#服务器进程工作方式">#</a> 服务器进程工作方式</h4><h5 id="循环方式"><a class="anchor" href="#循环方式">#</a> 循环方式</h5><p>无连接的，服务进程只使用一个服务套接字。每个客户则使用自己设定端口号的客户套接字。<br>当有多个客户进程请求服务时，服务进程就按请求的先后顺序依次做出响应 (阻塞方式)。</p><h5 id="并发方式"><a class="anchor" href="#并发方式">#</a> 并发方式</h5><p>面向连接，同时运行多个服务进程。<br>主服务进程创建从属服务进程，所有这些套接字都可使用服务器的相同端口号，也可以使用新的端口号。</p><h3 id="域名系统"><a class="anchor" href="#域名系统">#</a> 域名系统</h3><p>… . 三级域名。二级域名。顶级域名</p><h4 id="域名服务器"><a class="anchor" href="#域名服务器">#</a> 域名服务器</h4><p>域名与 IP 地址可以是一对一、一对多或者多对一的关系；域名解析过程对用户透明<br>域名通过域名解析转化为 IP 地址</p><p>分为权威名字服务器和递归解析器。</p><p>根据对应域的层次，权威名字服务器又进一步分为根名字服务器、顶级域名字服务器、二级域名字服务器、三级域名字服务器<br><strong>本地域名服务器</strong>（三级域及以下的名字服务器 (<span class="exturl" data-url="aHR0cDovL3huLS10c2luZ2h1YS1reDJtMjYzZi5lZHUuY24=">例如 tsinghua.edu.cn</span>) 通常在用户本地区域）</p><p>根服务器共有 13 套，1000 多台镜像根服务器（<span class="exturl" data-url="aHR0cDovL2Eucm9vdHNlcnZlcnMubmV0">a.rootservers.net</span> － <span class="exturl" data-url="aHR0cDovL20ucm9vdHNlcnZlcnMubmV0">m.rootservers.net</span>）</p><h4 id="域名解析过程"><a class="anchor" href="#域名解析过程">#</a> 域名解析过程</h4><p>该应用进程将所需要的域名放在 DNS 请求报文，发送给域名服务器<br>有<strong>递归查询</strong>和<strong>迭代查询</strong>两种方式<br>主机向递归解析器 / 本地域名字服务器的查询一般采用递归查询<br>递归解析器 / 本地域名字服务器向根服务器可以采用递归查询，但一般优先采用迭代查询<br>DNS 下层使用 UDP 数据报，端口号为 53</p><p>域名服务器广泛使用<strong>高速缓存</strong>，存放最近查询过的域名以及从何处获得域名映射信息的记录<br>生存时间 TTL，在报文中以秒为单位</p><h4 id="dns报文"><a class="anchor" href="#dns报文">#</a> DNS 报文</h4><p>下层为 UDP，端口 53。<br>DNS 资源记录的类型 RR 格式：(name, ttl, class, type, value)<br>type = A，name 是主机名，value 是主机 IPv4 地址<br>type = AAAA，name 是主机名，value 是主机 IPv6 地址<br>type = CNAME，name 是某些 “规范” 名称的别名，例如 www.cs.vu.nl. 是主机名 papac022.vu.nl. 的别名，value 是 IP 地址<br>type = MX，name 是请求域名，value 是与请求域名关联的 SMTP 邮件服务器的名称</p><h4 id="dnssec"><a class="anchor" href="#dnssec">#</a> DNSSEC</h4><p>DNS 面临安全问题<br>域名服务器用自己的私有密钥对资源记录（Resource Record, RR）进行签名，解析服务器用域名服务器的公开密钥对收到的应答信息进行验证</p><h3 id="万维网"><a class="anchor" href="#万维网">#</a> 万维网</h3><p>统一资源定位器 URLs（http，https，ftp...）<br>静态 Web<br>动态 Web：<br>通用网关接口 CGI，在服务器端执行；脚本程序在客户端浏览器内执行</p><h3 id="http"><a class="anchor" href="#http">#</a> HTTP</h3><p>在传输层通常使用<strong> TCP</strong> 协议，缺省使用 TCP 的 80 端口</p><p>HTTP 1.0，每次请求都需要经历 TCP 三次握手过程以及关闭 TCP 连接过程，缺省为非持久连接，每次连接需要经历 TCP 慢启动阶段。<br>HTTP 1.1，缺省为持久连接，响应后保持连接，经历较少的慢启动过程，减少往返时间。<br>HTTP 1.1-pipeline，支持多个流水线。<br>HTTPS：HTTP+TLS（2008），在 TCP 之上增加 SSL/TLS（TLS 1.2）层，提供安全机制。</p><p>报文由三个部分组成，即开始行、首部行和实体主体<br>请求报文开始行：方法 + URL + 版本 + 换行符（分割）<br>响应报文开始行：版本 + 状态码 + 短语 + 换行符（分割）</p><p>代理服务器 (proxy server)，又称为万维网高速缓存 (Web cache)，它代表浏览器发出 HTTP 请求，把最近的一些请求和响应暂存在本地磁盘中，请求到达时不需要按 URL 的地址再去互联网访问该资源</p><p>访问服务时先与 Proxy 建立连接，若高速缓存已经存放了所请求的对象，则直接返回，否则与源点服务器建立 TCP 连接并发送 HTTP 请求，源点服务器将对象返回给 Proxy，高速缓存在复制之后返回客户。</p><p>浏览器缓存：再次访问缓存在浏览器主机中的 Web 页副本，不必从原始服务器读取。<br>通过特殊的关键字头询问原始服务器，Web 副本对应的原始 Web 页是否已更新。<br>客户端：在发送的 HTTP 请求中指定缓存的时间。<br>服务器：如果缓存的对象是最新的，在响应时无需包含该对象，304 Not Modified<br>原始服务器明确指令限制缓存某些 Web 页。</p><p>Web 服务器可以限定客户端访问的 IP 地址空间，也可以限制访问人员。<br>服务器用 cookies 保持用户状态，Cookie 文件保存在用户主机中，内容是服务器返回的一些附加信息，由用户主机的浏览器管理。</p><h2 id="ch08-02-应用层进阶"><a class="anchor" href="#ch08-02-应用层进阶">#</a> CH08-02 应用层进阶</h2><h3 id="电子邮件"><a class="anchor" href="#电子邮件">#</a> 电子邮件</h3><h4 id="smtp"><a class="anchor" href="#smtp">#</a> SMTP</h4><p>利用 <strong>TCP</strong> 可靠地从客户向服务器传递邮件。<br>3 个阶段：连接建立、邮件传送、连接关闭<br>不断重复：<strong>命令 - 响应</strong><br>接收方不能用 SMTP</p><h4 id="最终交付协议"><a class="anchor" href="#最终交付协议">#</a> 最终交付协议</h4><p>POP3, IMAP, HTTP</p><p>POP3 的三个阶段：认证（user + pass），事务处理阶段，更新阶段，<strong>TCP</strong> 端口 110<br>IMAP：IMAP 允许用户使用不同计算机同步和处理邮件，IMAP 服务器把每个邮件与一个文件夹联系起来，当邮件到达服务器时，它与收件人的 INBOX 文件夹相关联，IMAP 具有允许用户代理获取邮件某些部分的命令，提供了在远程文件夹中查询邮件的命令，维护了 IMAP 会话的用户状态信息<br>HTTP (Webmail)：同 HTTP</p><h3 id="流式音频和视频"><a class="anchor" href="#流式音频和视频">#</a> 流式音频和视频</h3><h4 id="流媒体"><a class="anchor" href="#流媒体">#</a> 流媒体</h4><p>时序性约束：流媒体数据必须按照一定的顺序连续播放，丢失部分数据包也可完成基本功能<br>MPEG 视频压缩思路：输出包括帧内编码帧（I 帧），预测帧（P 帧，前一帧逐块差值），双向帧（B 帧，前后逐块差值）（GOP 图像组）<br>任意一帧发生了接收错误，则后续非 I 帧无法解码，因此 I 帧必须周期性地出现在媒体流中。</p><p>浏览器从服务器下载流媒体文件，先用 HTTP GET 提取元文件（有音 / 视频文件的统一资源定位符 URL），之后媒体播放器使用元文件发送 HTTP 要求下载音视频，边下载边解压缩边播放（通过时间戳同步音频流和视频流）。<br>发送端以恒定速率产生数据分组，由于网络传输的抖动特性，分组到达接收端时变成了非恒定速率。<br>在接收端经过缓存后，再以恒定速率播放（推迟）<br>实际流媒体系统往往先尝试 UDP，如果失败则转为 TCP</p><h4 id="实时流式协议-rtsp"><a class="anchor" href="#实时流式协议-rtsp">#</a> 实时流式协议 RTSP</h4><p>本身不传送数据，是一个多媒体播放控制协议，记录用户所处于的状态<br>对用户下载的实时数据的播放情况进行控制，如：暂停 / 继续、后退、前进等（PLAY-RESPONSE，TEARDOWN-RESPONSE），数据的传输用 RTP</p><h4 id="实时传输协议-rtp实时传输控制协议-rtcp"><a class="anchor" href="#实时传输协议-rtp实时传输控制协议-rtcp">#</a> 实时传输协议 RTP，实时传输控制协议 RTCP</h4><p>不提供任何服务质量的保证，不对多媒体数据块做任何处理，而只是向应用层提供一些附加的信息，让应用层知道应当如何进行处理。<br>RTCP 分组周期性地在网上传送，它带有发送端和接收端对服务质量的统计信息报告。</p><h4 id="webrtc"><a class="anchor" href="#webrtc">#</a> WebRTC</h4><p>开源项目，建立浏览器之间点对点的连接，实现音 / 视频流的传输</p><h4 id="动态自适应流媒体传输协议-dash"><a class="anchor" href="#动态自适应流媒体传输协议-dash">#</a> 动态自适应流媒体传输协议 DASH</h4><p>完整视频被拆分为固定时长 (2s-10s) 的视频片段 (segment)，每段提供不同码率<br>客户端自适应选择合适的视频码率来下载</p><p>自适应码率 ABR：基于吞吐量和缓冲区状态切换码率，如果算法检测到下载该视频块的过程有卡顿，则终止当前请求，转而重新下载相应的低码率视频块<br>可扩展视频编码 SVC：编码器产生的码流包含多个可以单独解码的子码流，确保传输基础层来避免卡顿，使用富裕的带宽传输增强层，充分利用带宽</p><h3 id="内容分发"><a class="anchor" href="#内容分发">#</a> 内容分发</h3><p>代理缓存扩展 Web，将服务器内容缓存到客户上以提高性能<br>内容分发网络 CDN，CDN 节点缓存数据副本，订阅者请求数据，服务提供者返回 CDN 清单，客户端通过清单从 CDN 节点上获取内容（HTTP 重定向请求内容）<br>将请求调度到较近或负载较轻的 CDN 服务器，负载均衡 DNS 负责决策 CDN 服务器选择，负载均衡 DNS 需要收集 CDN 服务器的位置和负载情况。</p><h3 id="远程登录协议-telnet"><a class="anchor" href="#远程登录协议-telnet">#</a> 远程登录协议 Telnet</h3><p>通过 ASCII 终端，实现对远程计算机系统的访问，就像访问本地资源一样，议使用 C/S 方式实现，服务器进程默认监听 TCP 23 端口，使用主进程等待新的请求，并产生从属进程来处理每一个连接。<br>TCP 连接使用 NVT 格式（网络虚拟终端），并用通用字符集保证兼容性。</p><h3 id="文件传输协议-ftp"><a class="anchor" href="#文件传输协议-ftp">#</a> 文件传输协议 FTP</h3><p>控制连接（服务器 <strong>TCP</strong> 21 端口）在整个会话期间一直保持，客户进程发出的文件传输请求通过控制连接发送给服务器控制进程，服务器的控制进程创建数据传输进程（TCP 20 端口）和数据连接，数据连接用来连接客户进程和服务器数据传输进程，实际完成文件的传输。</p><h3 id="简单网络管理协议-snmp"><a class="anchor" href="#简单网络管理协议-snmp">#</a> 简单网络管理协议 SNMP</h3><p>了解网络的运行状态（配置状态），及时报告和处理网络故障。<br>管理信息库 MIB 指明了网络元素所维持的变量（即能够被管理进程查询和设置的信息）。SNMP 的管理信息库采用和域名系统 DNS 相似的树型结构，它的根在最上面，根没有名字。它又称为对象命名树（Object Naming Tree）。<br>轮询方式：<strong>UDP</strong> 161 端口<br>“读” 操作：管理器向代理发送 get 报文来检测管理对象状态；“写” 操作：管理器向代理发送 set 报文来修改管理对象状态。<br>陷阱（trap）方式：允许代理不经过管理器询问就能发送某些信息，代表代理检测到的重要事件</p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2024-01-29 17:03:04" itemprop="dateModified" datetime="2024-01-29T17:03:04+08:00">2024-01-29</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Linxin Xiao <i class="ic i-at"><em>@</em></i>·恆 ·極 ·諭</li><li class="link"><strong>本文链接：</strong> <a href="https://ekkoxiao.github.io/2024/01/29/cs/net/net/" title="计算机网络原理课程笔记">https://ekkoxiao.github.io/2024/01/29/cs/net/net/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2024/01/28/cs/dsa/dsa/" itemprop="url" rel="prev" data-background-image="&#x2F;assets&#x2F;dsa.png" title="数据结构课程笔记"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 数据结构</span><h3>数据结构课程笔记</h3></a></div><div class="item right"><a href="/2024/01/29/cs/safety/safety/" itemprop="url" rel="next" data-background-image="&#x2F;assets&#x2F;safety.png" title="计算机网络安全技术课程笔记"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 网络安全技术</span><h3>计算机网络安全技术课程笔记</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ch01-01-%E5%BC%95%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">CH01-01 引言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dos-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="toc-number">1.1.</span> <span class="toc-text">DoS 拒绝服务攻击</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch02-01-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">2.</span> <span class="toc-text">CH02-01 计算机网络体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.1.</span> <span class="toc-text">电路交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E6%96%87%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.2.</span> <span class="toc-text">报文交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.3.</span> <span class="toc-text">分组交换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E4%B8%8E%E5%88%86%E5%B1%82%E7%BB%93%E6%9E%84"><span class="toc-number">2.4.</span> <span class="toc-text">协议与分层结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%A6%E9%87%8F%E5%8D%95%E4%BD%8D"><span class="toc-number">2.5.</span> <span class="toc-text">度量单位</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch03-01-%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">3.</span> <span class="toc-text">CH03-01 物理层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">3.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%AE%BD%E4%BF%A1%E5%8F%B7"><span class="toc-number">3.2.</span> <span class="toc-text">带宽信号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E6%96%B9%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text">传输方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E4%BB%8B%E8%B4%A8"><span class="toc-number">3.4.</span> <span class="toc-text">传输介质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E8%B0%83%E5%88%B6%E4%B8%8E%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="toc-number">3.5.</span> <span class="toc-text">数字调制与多路复用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E5%B8%A6%E4%BC%A0%E8%BE%93"><span class="toc-number">3.5.1.</span> <span class="toc-text">基带传输</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%91%E5%B8%A6%E4%BC%A0%E8%BE%93"><span class="toc-number">3.5.2.</span> <span class="toc-text">频带传输</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E7%94%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">3.5.3.</span> <span class="toc-text">复用技术</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch04-01-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E5%9F%BA%E7%A1%80"><span class="toc-number">4.</span> <span class="toc-text">CH04-01 数据链路层基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%90%E5%B8%A7"><span class="toc-number">4.1.</span> <span class="toc-text">成帧</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E8%8A%82%E8%AE%A1%E6%95%B0%E6%B3%95"><span class="toc-number">4.1.1.</span> <span class="toc-text">字节计数法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E5%AD%97%E8%8A%82%E5%A1%AB%E5%85%85%E7%9A%84%E5%AE%9A%E7%95%8C%E7%AC%A6%E6%B3%95"><span class="toc-number">4.1.2.</span> <span class="toc-text">带字节填充的定界符法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E6%AF%94%E7%89%B9%E5%A1%AB%E5%85%85%E7%9A%84%E5%AE%9A%E7%95%8C%E7%AC%A6%E6%B3%95"><span class="toc-number">4.1.3.</span> <span class="toc-text">带比特填充的定界符法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82%E7%BC%96%E7%A0%81%E8%BF%9D%E4%BE%8B"><span class="toc-number">4.1.4.</span> <span class="toc-text">物理层编码违例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%AE%E9%94%99%E6%A3%80%E6%B5%8B%E5%92%8C%E7%BA%A0%E6%AD%A3"><span class="toc-number">4.2.</span> <span class="toc-text">差错检测和纠正</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%B7%E6%98%8E%E8%B7%9D%E7%A6%BB"><span class="toc-number">4.2.1.</span> <span class="toc-text">海明距离</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A3%80%E9%94%99%E7%A0%81"><span class="toc-number">4.2.2.</span> <span class="toc-text">检错码</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A0%A1%E9%AA%8C-crc"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">循环冗余校验 CRC</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A0%E9%94%99%E7%A0%81%E6%B5%B7%E6%98%8E%E7%A0%81"><span class="toc-number">4.2.3.</span> <span class="toc-text">纠错码 —— 海明码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%9A%84%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.</span> <span class="toc-text">基本的数据链路层协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%8C%E6%89%98%E9%82%A6%E5%BC%8F%E5%8D%95%E5%B7%A5%E5%8D%8F%E8%AE%AE-p1"><span class="toc-number">4.3.1.</span> <span class="toc-text">乌托邦式单工协议 P1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E9%94%99%E4%BF%A1%E9%81%93%E4%B8%8A%E7%9A%84%E5%8D%95%E5%B7%A5%E5%81%9C%E7%AD%89%E5%BC%8F%E5%8D%8F%E8%AE%AE-p2"><span class="toc-number">4.3.2.</span> <span class="toc-text">无错信道上的单工停等式协议 P2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E9%94%99%E4%BF%A1%E9%81%93%E4%B8%8A%E7%9A%84%E5%8D%95%E5%B7%A5%E5%81%9C%E7%AD%89%E5%BC%8F%E5%8D%8F%E8%AE%AE-p3"><span class="toc-number">4.3.3.</span> <span class="toc-text">有错信道上的单工停等式协议 P3</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch04-02"><span class="toc-number">5.</span> <span class="toc-text">CH04-02</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.1.</span> <span class="toc-text">滑动窗口协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E7%AA%97%E5%8F%A3"><span class="toc-number">5.1.1.</span> <span class="toc-text">发送窗口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E7%AA%97%E5%8F%A3"><span class="toc-number">5.1.2.</span> <span class="toc-text">接收窗口</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E6%AF%94%E7%89%B9%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E5%8D%8F%E8%AE%AE-p4"><span class="toc-number">5.2.</span> <span class="toc-text">一比特滑动窗口协议 P4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E9%80%80-n-%E5%8D%8F%E8%AE%AE-p5"><span class="toc-number">5.3.</span> <span class="toc-text">回退 N 协议 P5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E9%87%8D%E4%BC%A0%E5%8D%8F%E8%AE%AE-p6"><span class="toc-number">5.4.</span> <span class="toc-text">选择重传协议 P6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ppp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.5.</span> <span class="toc-text">PPP 协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch05-01-%E4%BB%8B%E8%B4%A8%E8%AE%BF%E9%97%AE%E5%AD%90%E5%B1%82%E5%9F%BA%E7%A1%80"><span class="toc-number">6.</span> <span class="toc-text">CH05-01 介质访问子层基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E7%BD%AE"><span class="toc-number">6.1.</span> <span class="toc-text">位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%AF-aloha"><span class="toc-number">6.2.</span> <span class="toc-text">纯 ALOHA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E9%9A%99-aloha"><span class="toc-number">6.3.</span> <span class="toc-text">分隙 ALOHA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE-csma"><span class="toc-number">6.4.</span> <span class="toc-text">载波侦听多路访问协议 CSMA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%8D%E5%9B%BE%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.5.</span> <span class="toc-text">位图协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%80%92%E8%AE%A1%E6%95%B0%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.6.</span> <span class="toc-text">二进制倒计数协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ieee-8025-%E4%BB%A4%E7%89%8C%E7%8E%AF"><span class="toc-number">6.7.</span> <span class="toc-text">IEEE 802.5 令牌环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E9%80%82%E5%BA%94%E6%A0%91%E6%90%9C%E7%B4%A2%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.8.</span> <span class="toc-text">自适应树搜索协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">6.9.</span> <span class="toc-text">以太网</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#csmacd"><span class="toc-number">6.9.1.</span> <span class="toc-text">CSMA&#x2F;CD</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">6.10.</span> <span class="toc-text">经典以太网</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch05-02-%E5%8F%AF%E6%89%A9%E5%B1%95%E7%9A%84%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">7.</span> <span class="toc-text">CH05-02 可扩展的以太网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%E4%BA%A4%E6%8D%A2%E5%8E%9F%E7%90%86"><span class="toc-number">7.1.</span> <span class="toc-text">链路层交换原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mac-%E5%9C%B0%E5%9D%80%E8%A1%A8"><span class="toc-number">7.1.1.</span> <span class="toc-text">MAC 地址表</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E5%8D%8F%E8%AE%AE"><span class="toc-number">7.2.</span> <span class="toc-text">生成树协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E7%8E%AF%E8%B7%AF%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">7.2.1.</span> <span class="toc-text">物理环路的问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%A5%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83-bpdu"><span class="toc-number">7.2.2.</span> <span class="toc-text">桥协议数据单元 BPDU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E9%80%89%E4%B8%BE"><span class="toc-number">7.2.3.</span> <span class="toc-text">生成树选举</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E8%B7%AF%E7%94%B1%E7%BD%91%E6%A1%A5"><span class="toc-number">7.2.4.</span> <span class="toc-text">源路由网桥</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA"><span class="toc-number">7.3.</span> <span class="toc-text">链路层交换机</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%A8%A1%E5%BC%8F"><span class="toc-number">7.3.1.</span> <span class="toc-text">交换模式</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91-vlan"><span class="toc-number">7.4.</span> <span class="toc-text">虚拟局域网 VLAN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mac%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91-wlan"><span class="toc-number">8.</span> <span class="toc-text">MAC：无线局域网 WLAN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91%E7%BB%84%E7%BD%91%E6%A8%A1%E5%BC%8F"><span class="toc-number">8.1.</span> <span class="toc-text">无线局域网组网模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#csmaca-%E5%B8%A6%E5%86%B2%E7%AA%81%E9%81%BF%E5%85%8D%E7%9A%84%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE-ieee-80211"><span class="toc-number">8.2.</span> <span class="toc-text">CSMA&#x2F;CA 带冲突避免的载波侦听多路访问 IEEE 802.11</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95"><span class="toc-number">8.2.1.</span> <span class="toc-text">算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cwindow-%E9%80%89%E5%8F%96"><span class="toc-number">8.2.2.</span> <span class="toc-text">CWindow 选取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A7%E9%97%B4%E9%9A%99%E6%8E%A7%E5%88%B6%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">8.2.3.</span> <span class="toc-text">帧间隙控制优先级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rts-cts-%E6%9C%BA%E5%88%B6"><span class="toc-number">8.2.4.</span> <span class="toc-text">RTS-CTS 机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A7%E6%A0%BC%E5%BC%8F"><span class="toc-number">8.2.5.</span> <span class="toc-text">帧格式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch06-01-%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80"><span class="toc-number">9.</span> <span class="toc-text">CH06-01 网络层基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ip-%E5%9C%B0%E5%9D%80"><span class="toc-number">9.1.</span> <span class="toc-text">IP 地址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E5%9F%BA%E7%A1%80%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.</span> <span class="toc-text">网络层基础协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dhcp-%E5%8A%A8%E6%80%81%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.1.</span> <span class="toc-text">DHCP 动态主机配置协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#arp-%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.2.</span> <span class="toc-text">ARP 地址解析协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#icmp-%E4%BA%92%E8%81%94%E7%BD%91%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.3.</span> <span class="toc-text">ICMP 互联网控制报文协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch06-02-%E7%BD%91%E7%BB%9C%E5%B1%82%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE"><span class="toc-number">10.</span> <span class="toc-text">CH06-02 网络层：路由协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%9D%E7%A6%BB%E5%90%91%E9%87%8F%E7%AE%97%E6%B3%95%E5%92%8C-rip"><span class="toc-number">10.1.</span> <span class="toc-text">距离向量算法和 RIP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">10.1.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95-2"><span class="toc-number">10.1.2.</span> <span class="toc-text">算法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E7%AE%97%E6%B3%95%E5%92%8C-ospf"><span class="toc-number">10.2.</span> <span class="toc-text">链路状态算法和 OSPF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95-3"><span class="toc-number">10.2.1.</span> <span class="toc-text">算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E6%AF%94"><span class="toc-number">10.2.2.</span> <span class="toc-text">对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E8%B7%AF%E7%94%B1%E5%92%8C%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE-bgp"><span class="toc-number">10.3.</span> <span class="toc-text">层次路由和域间路由协议 BGP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%81%9A%E5%90%88"><span class="toc-number">10.3.1.</span> <span class="toc-text">地址聚合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bgp-%E5%A4%96%E9%83%A8%E7%BD%91%E5%85%B3%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE"><span class="toc-number">10.3.2.</span> <span class="toc-text">BGP 外部网关路由协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch06-03-%E7%BD%91%E7%BB%9C%E5%B1%82%E8%BF%9B%E9%98%B6"><span class="toc-number">11.</span> <span class="toc-text">CH06-03 网络层进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E7%94%B5%E8%B7%AF%E8%BD%AC%E5%8F%91%E7%AD%96%E7%95%A5"><span class="toc-number">11.1.</span> <span class="toc-text">虚电路转发策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E5%8D%8F%E8%AE%AE%E6%A0%87%E7%AD%BE%E4%BA%A4%E6%8D%A2-mpls"><span class="toc-number">11.2.</span> <span class="toc-text">多协议标签交换 MPLS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">11.3.</span> <span class="toc-text">路由器体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E6%8E%A7%E5%88%B6%E5%B9%B3%E9%9D%A2"><span class="toc-number">11.3.1.</span> <span class="toc-text">路由器控制平面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E6%95%B0%E6%8D%AE%E5%B9%B3%E9%9D%A2"><span class="toc-number">11.3.2.</span> <span class="toc-text">路由器数据平面</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nat-%E6%8A%80%E6%9C%AF"><span class="toc-number">11.4.</span> <span class="toc-text">NAT 技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ipv6-%E5%8D%8F%E8%AE%AE"><span class="toc-number">11.5.</span> <span class="toc-text">IPv6 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E8%BF%81%E7%A7%BB"><span class="toc-number">11.5.1.</span> <span class="toc-text">协议迁移</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F%E4%B8%8E%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">11.6.</span> <span class="toc-text">服务质量与拥塞控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%E6%95%B4%E5%BD%A2"><span class="toc-number">11.6.1.</span> <span class="toc-text">流量整形</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E6%9C%8D%E5%8A%A1-intserv"><span class="toc-number">11.6.2.</span> <span class="toc-text">综合服务 IntServ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BA%E5%88%86%E6%9C%8D%E5%8A%A1-diffserv"><span class="toc-number">11.6.3.</span> <span class="toc-text">区分服务 DiffServ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E8%B4%A8%E9%87%8F%E8%B7%AF%E7%94%B1-qosr"><span class="toc-number">11.6.4.</span> <span class="toc-text">服务质量路由 QoSR</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch07-01-%E4%BC%A0%E8%BE%93%E5%B1%82%E5%9F%BA%E7%A1%80"><span class="toc-number">12.</span> <span class="toc-text">CH07-01 传输层基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E6%9C%8D%E5%8A%A1%E5%A4%8D%E7%94%A8%E4%B8%8E%E5%88%86%E7%94%A8"><span class="toc-number">12.1.</span> <span class="toc-text">传输层服务：复用与分用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#udp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">12.2.</span> <span class="toc-text">UDP 协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">12.3.</span> <span class="toc-text">TCP 协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">12.4.</span> <span class="toc-text">拥塞控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E6%97%B6%E5%99%A8"><span class="toc-number">12.5.</span> <span class="toc-text">计时器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E5%AE%9A%E6%97%B6%E5%99%A8"><span class="toc-number">12.5.1.</span> <span class="toc-text">超时定时器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8C%81%E7%BB%AD%E8%AE%A1%E6%97%B6%E5%99%A8"><span class="toc-number">12.5.2.</span> <span class="toc-text">持续计时器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%9D%E6%B4%BB%E8%AE%A1%E6%97%B6%E5%99%A8"><span class="toc-number">12.5.3.</span> <span class="toc-text">保活计时器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch07-02-%E4%BC%A0%E8%BE%93%E5%B1%82%E8%BF%9B%E9%98%B6"><span class="toc-number">13.</span> <span class="toc-text">CH07-02 传输层进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bic"><span class="toc-number">13.1.</span> <span class="toc-text">BIC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cubic"><span class="toc-number">13.2.</span> <span class="toc-text">CUBIC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E4%B8%8E%E7%93%B6%E9%A2%88%E9%93%BE%E8%B7%AF%E5%B8%A6%E5%AE%BD"><span class="toc-number">13.3.</span> <span class="toc-text">拥塞与瓶颈链路带宽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bbr"><span class="toc-number">13.4.</span> <span class="toc-text">BBR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#quic"><span class="toc-number">13.5.</span> <span class="toc-text">QUIC</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%BB%BA%E7%AB%8B%E6%97%B6%E5%BB%B6%E4%BC%98%E5%8C%96"><span class="toc-number">13.5.1.</span> <span class="toc-text">连接建立时延优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E9%87%8D%E4%BC%A0"><span class="toc-number">13.5.2.</span> <span class="toc-text">优化重传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8%E5%88%87%E6%8D%A2%E8%BF%9E%E6%8E%A5%E7%AE%A1%E7%90%86"><span class="toc-number">13.5.3.</span> <span class="toc-text">移动切换连接管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8B%AC%E7%AB%8B%E5%AD%90%E6%B5%81%E5%87%8F%E8%BD%BB%E9%98%9F%E5%A4%B4%E9%98%BB%E5%A1%9E"><span class="toc-number">13.5.4.</span> <span class="toc-text">独立子流减轻队头阻塞</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mptcp"><span class="toc-number">13.6.</span> <span class="toc-text">MPTCP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch08-01-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">14.</span> <span class="toc-text">CH08-01 应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E6%A6%82%E8%BF%B0"><span class="toc-number">14.1.</span> <span class="toc-text">应用层概述</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#cs"><span class="toc-number">14.1.1.</span> <span class="toc-text">C&#x2F;S</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bs"><span class="toc-number">14.1.2.</span> <span class="toc-text">B&#x2F;S</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#p2p"><span class="toc-number">14.1.3.</span> <span class="toc-text">P2P</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E7%A8%8B%E5%B7%A5%E4%BD%9C%E6%96%B9%E5%BC%8F"><span class="toc-number">14.1.4.</span> <span class="toc-text">服务器进程工作方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E6%96%B9%E5%BC%8F"><span class="toc-number">14.1.4.1.</span> <span class="toc-text">循环方式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E6%96%B9%E5%BC%8F"><span class="toc-number">14.1.4.2.</span> <span class="toc-text">并发方式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F"><span class="toc-number">14.2.</span> <span class="toc-text">域名系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">14.2.1.</span> <span class="toc-text">域名服务器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B"><span class="toc-number">14.2.2.</span> <span class="toc-text">域名解析过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dns%E6%8A%A5%E6%96%87"><span class="toc-number">14.2.3.</span> <span class="toc-text">DNS 报文</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dnssec"><span class="toc-number">14.2.4.</span> <span class="toc-text">DNSSEC</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%87%E7%BB%B4%E7%BD%91"><span class="toc-number">14.3.</span> <span class="toc-text">万维网</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http"><span class="toc-number">14.4.</span> <span class="toc-text">HTTP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ch08-02-%E5%BA%94%E7%94%A8%E5%B1%82%E8%BF%9B%E9%98%B6"><span class="toc-number">15.</span> <span class="toc-text">CH08-02 应用层进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6"><span class="toc-number">15.1.</span> <span class="toc-text">电子邮件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#smtp"><span class="toc-number">15.1.1.</span> <span class="toc-text">SMTP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E7%BB%88%E4%BA%A4%E4%BB%98%E5%8D%8F%E8%AE%AE"><span class="toc-number">15.1.2.</span> <span class="toc-text">最终交付协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E5%BC%8F%E9%9F%B3%E9%A2%91%E5%92%8C%E8%A7%86%E9%A2%91"><span class="toc-number">15.2.</span> <span class="toc-text">流式音频和视频</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E5%AA%92%E4%BD%93"><span class="toc-number">15.2.1.</span> <span class="toc-text">流媒体</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E6%B5%81%E5%BC%8F%E5%8D%8F%E8%AE%AE-rtsp"><span class="toc-number">15.2.2.</span> <span class="toc-text">实时流式协议 RTSP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E6%97%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE-rtp%E5%AE%9E%E6%97%B6%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE-rtcp"><span class="toc-number">15.2.3.</span> <span class="toc-text">实时传输协议 RTP，实时传输控制协议 RTCP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#webrtc"><span class="toc-number">15.2.4.</span> <span class="toc-text">WebRTC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%87%AA%E9%80%82%E5%BA%94%E6%B5%81%E5%AA%92%E4%BD%93%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE-dash"><span class="toc-number">15.2.5.</span> <span class="toc-text">动态自适应流媒体传输协议 DASH</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91"><span class="toc-number">15.3.</span> <span class="toc-text">内容分发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E7%99%BB%E5%BD%95%E5%8D%8F%E8%AE%AE-telnet"><span class="toc-number">15.4.</span> <span class="toc-text">远程登录协议 Telnet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE-ftp"><span class="toc-number">15.5.</span> <span class="toc-text">文件传输协议 FTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AE-snmp"><span class="toc-number">15.6.</span> <span class="toc-text">简单网络管理协议 SNMP</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2024/01/29/cs/net/net/" rel="bookmark" title="计算机网络原理课程笔记">计算机网络原理课程笔记</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Linxin Xiao" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Linxin Xiao</p><div class="description" itemprop="description">Tsinghua University, Peking</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">5</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">4</span> <span class="name">分类</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2Vra294aWFv" title="https:&#x2F;&#x2F;github.com&#x2F;ekkoxiao"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnhseDIxQG1haWxzLnRzaW5naHVhLmVkdS5jbg==" title="mailto:xlx21@mails.tsinghua.edu.cn"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2024/01/28/cs/dsa/dsa/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2024/01/29/cs/safety/safety/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机专业课程笔记">计算机专业课程笔记</a> <i class="ic i-angle-right"></i> <a href="/categories/cs/dsa/" title="分类于 数据结构">数据结构</a></div><span><a href="/2024/01/28/cs/dsa/dsa/" title="数据结构课程笔记">数据结构课程笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机专业课程笔记">计算机专业课程笔记</a> <i class="ic i-angle-right"></i> <a href="/categories/cs/safety/" title="分类于 网络安全技术">网络安全技术</a></div><span><a href="/2024/01/29/cs/safety/safety/" title="计算机网络安全技术课程笔记">计算机网络安全技术课程笔记</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2024/01/28/intro/" title="个人简介">个人简介</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/cs/" title="分类于 计算机专业课程笔记">计算机专业课程笔记</a> <i class="ic i-angle-right"></i> <a href="/categories/cs/net/" title="分类于 计算机网络原理">计算机网络原理</a></div><span><a href="/2024/01/29/cs/net/net/" title="计算机网络原理课程笔记">计算机网络原理课程笔记</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2024/01/28/casual/" title="随笔">随笔</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Linxin Xiao @ Homepage for EkkoXiao</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">70k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:03</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2024/01/29/cs/net/net/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->